<UserControl
    x:Class="aEMR.ConsultantEPrescription.Views.PatientTreeFormView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Resources="clr-namespace:eHCMSLanguage;assembly=aEMRLanguage"
    xmlns:cal="http://www.caliburnproject.org"
    xmlns:converters="clr-namespace:aEMR.Common.Converters;assembly=aEMR.Common"
    xmlns:customcontrols="clr-namespace:aEMR.Controls;assembly=aEMR.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:dxp="http://schemas.devexpress.com/winfx/2008/xaml/printing"
    xmlns:dxpdf="http://schemas.devexpress.com/winfx/2008/xaml/pdf"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
    xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
    d:DesignHeight="500"
    d:DesignWidth="900"
    mc:Ignorable="d">
    <UserControl.Resources>
        <converters:StringFormatConverter x:Key="StringFormatConverter" />
        <Resources:eHCMSResources x:Key="eHCMSResources" />
        <BooleanToVisibilityConverter x:Key="BooleanToVisibility" />
        <converters:FontBoldConverter x:Key="FontBoldConverter" />
        <converters:IfNotNullVisibilityConverter x:Key="IfNotNullVisibilityConverter" />
        <DataTemplate x:Key="DTtxtValue">
            <StackPanel
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Orientation="Horizontal">
                <TextBlock
                    Width="100"
                    Margin="0"
                    Padding="0"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Text="{Binding Value, Mode=TwoWay}"
                    Visibility="{Binding IsNoNeedResult, Converter={StaticResource VisibilityConverter}}" />
            </StackPanel>
        </DataTemplate>

        <DataTemplate x:Key="CTtblName">
            <TextBlock
                Name="chk_HI"
                MinWidth="150"
                Margin="0"
                Padding="0"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                FontWeight="{Binding IsBold, Converter={StaticResource FontBoldConverter}}"
                Text="{Binding PCLExamTestItemName, Mode=TwoWay}" />
        </DataTemplate>

        <DataTemplate x:Key="DTtxtValue_Old">
            <StackPanel
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Orientation="Horizontal">
                <TextBlock
                    Width="100"
                    Margin="0"
                    Padding="0"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Text="{Binding Value_Old, Mode=TwoWay}" />
            </StackPanel>
        </DataTemplate>

    </UserControl.Resources>
    <Border
        x:Name="BorderCanvas"
        Margin="1,1,1,1"
        Style="{StaticResource LightBlueBorderStyle}">
        <xctk:BusyIndicator BusyContent="{Binding DlgBusyContent}" IsBusy="{Binding DlgIsBusyFlag}">
            <Grid Visibility="{Binding mPatientSumaryRecord_Xem, Converter={StaticResource BooleanToVisibility}}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto" />
                    <RowDefinition Height="auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <StackPanel Orientation="Horizontal" Visibility="{Binding IsShowSummaryContent, Converter={StaticResource BooleanToVisibility}}">
                    <ContentControl
                        x:Name="SearchRegistrationContent"
                        Grid.Row="1"
                        HorizontalContentAlignment="Stretch"
                        VerticalContentAlignment="Stretch" />
                    <TextBlock
                        x:Name="TitleForm"
                        Margin="20,0,0,0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Style="{StaticResource MainFrame.TextBlock.Header.01}"
                        Text="{Binding T2588_G1_LSuBA, Source={StaticResource eHCMSResources}, ConverterParameter=Upper, Mode=OneWay, Converter={StaticResource StringFormatConverter}}" />
                </StackPanel>
                <Expander
                    Grid.Row="2"
                    Height="Auto"
                    Margin="0,0,0,0"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    HorizontalContentAlignment="Stretch"
                    VerticalContentAlignment="Stretch"
                    Background="#FFDBE5F1"
                    ExpandDirection="Down"
                    FontWeight="Bold"
                    Foreground="#CC0033"
                    Header="{Binding UCPatientProfileInfo.CurrentPatient.GeneralInfoString, Mode=OneWay}"
                    IsExpanded="False"
                    RenderTransformOrigin="0,0"
                    Visibility="{Binding IsShowSummaryContent, Converter={StaticResource BooleanToVisibility}}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="5*" />
                            <ColumnDefinition Width="1" MinWidth="1" />
                            <ColumnDefinition Width="2*" />
                        </Grid.ColumnDefinitions>

                        <ContentControl
                            x:Name="UCPatientProfileInfo"
                            Grid.Column="0"
                            HorizontalContentAlignment="Stretch"
                            VerticalContentAlignment="Stretch" />
                        <ContentControl
                            x:Name="UCDoctorProfileInfo"
                            Grid.Column="2"
                            HorizontalContentAlignment="Stretch"
                            VerticalContentAlignment="Stretch" />
                    </Grid>
                </Expander>
                <Grid Grid.Row="3" Visibility="{Binding IsShowSummaryContent, Converter={StaticResource BooleanToVisibility}}">
                    <ContentControl
                        Name="UCHeaderInfoPMR"
                        HorizontalContentAlignment="Stretch"
                        VerticalContentAlignment="Stretch" />
                </Grid>

                <Grid Grid.Row="4" Visibility="{Binding IsShowSummaryContent, Converter={StaticResource BooleanToVisibility}}">
                    <ContentControl
                        x:Name="UCPtRegDetailInfo"
                        HorizontalContentAlignment="Stretch"
                        VerticalContentAlignment="Stretch" />
                </Grid>

                <Grid
                    Grid.Row="5"
                    MinWidth="800"
                    MinHeight="500">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="300" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <StackPanel>
                        <ContentControl
                            Name="UCPatientTreeView"
                            VerticalAlignment="Stretch"
                            HorizontalContentAlignment="Stretch" />
                    </StackPanel>
                    <DockPanel Grid.Column="1">

                        <TabControl
                            Name="tabCommon"
                            Margin="0,0,0,0"
                            Style="{StaticResource MainFrame.TabControl}">
                            <!--  Chẩn đoán  -->
                            <TabItem
                                cal:Message.Attach="[Event Loaded]=[Action TabKhamBenh_Loaded($source)]"
                                Header="{Binding T2119_G1_KB, Source={StaticResource eHCMSResources}}"
                                Style="{StaticResource MainFrame.TabItem}"
                                Visibility="{Binding mTreatment, Converter={StaticResource BooleanToVisibility}}">
                                <Border
                                    Margin="2,2,0,2"
                                    Background="White"
                                    Style="{StaticResource LightBlueBorderStyle}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="auto" />
                                            <RowDefinition Height="auto" />
                                            <RowDefinition Height="auto" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>
                                        <TextBlock
                                            Grid.Row="0"
                                            Grid.Column="0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TextBlock.Heading.04}"
                                            Text="{Binding G1785_G1_TrieuChungDHieuLS, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}"
                                            TextWrapping="Wrap" />
                                        <!--<TextBlock Text="{Binding curDiagnosisTreatment.Diagnosis}" HorizontalAlignment="Left" VerticalAlignment="Center" Grid.Row="1" Grid.Column="1"  Style="{StaticResource TextBlock.Heading.04}" TextWrapping="Wrap"
                                                       MaxHeight="40"/>-->
                                        <TextBlock
                                            Grid.Row="1"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Margin="30,2,3,2"
                                            FontWeight="Normal"
                                            Foreground="Black"
                                            Text="{Binding curDiagnosisTreatment.Diagnosis, Mode=TwoWay}" />
                                        <TextBlock
                                            Grid.Row="2"
                                            Grid.Column="0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TextBlock.Heading.04}"
                                            Text="{Binding K1775_G1_CDoanXDinh2, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" />
                                        <!--<TextBlock Text="{Binding curDiagnosisTreatment.DiagnosisFinal}" Name="txtDiagnosis" Grid.Row="3" Grid.Column="1"  Margin="0,2,3,2"  Style="{StaticResource TextBlock.Heading.04}" TextWrapping="Wrap"/>-->
                                        <TextBlock
                                            Grid.Row="3"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Margin="30,2,3,2"
                                            FontWeight="Normal"
                                            Foreground="Black"
                                            Text="{Binding curDiagnosisTreatment.DiagnosisFinal, Mode=TwoWay}"
                                            TextWrapping="Wrap" />
                                        <!--  Oriented Treatment  -->
                                        <TextBlock
                                            Grid.Row="4"
                                            Grid.Column="0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TextBlock.Heading.04}"
                                            Text="{Binding Z3309_G1_DienBienBenh, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" />
                                        <!--<TextBlock Text="{Binding curDiagnosisTreatment.OrientedTreatment}" Name="txtOTreatment" Grid.Row="5" Grid.Column="1" Margin="0,2,3,2"  Style="{StaticResource TextBlock.Heading.04}" TextWrapping="Wrap"/>-->
                                        <TextBlock
                                            Grid.Row="5"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Margin="30,2,3,2"
                                            FontWeight="Normal"
                                            Foreground="Black"
                                            Text="{Binding curDiagnosisTreatment.OrientedTreatment, Mode=TwoWay}"
                                            TextWrapping="Wrap" />
                                        <TextBlock
                                            Grid.Row="6"
                                            Grid.Column="0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TextBlock.Heading.04}"
                                            Text="{Binding Z0021_G1_CachDTri, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" />
                                        <!--<TextBlock Text="{Binding curDiagnosisTreatment.Treatment}" Grid.Row="7" Grid.Column="1" Margin="0,2,3,2"  Style="{StaticResource TextBlock.Heading.04}" TextWrapping="Wrap"/>-->
                                        <TextBlock
                                            Grid.Row="7"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Margin="30,2,3,2"
                                            FontWeight="Normal"
                                            Foreground="Black"
                                            Text="{Binding curDiagnosisTreatment.Treatment, Mode=TwoWay}"
                                            TextWrapping="Wrap" />
                                        <!--  Doctor comments  -->
                                        <TextBlock
                                            Grid.Row="8"
                                            Grid.Column="0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TextBlock.Heading.04}"
                                            Text="{Binding K2235_G1_ChuThich2, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" />
                                        <!--<TextBlock Text="{Binding curDiagnosisTreatment.DoctorComments}" Name="txtDComments" Grid.Row="9" MinHeight="40" Grid.Column="1"  Margin="0,2,3,2" Style="{StaticResource TextBlock.Heading.04}" TextWrapping="Wrap"/>-->

                                        <TextBlock
                                            Grid.Row="9"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            MaxHeight="40"
                                            Margin="30,2,3,2"
                                            FontWeight="Normal"
                                            Foreground="Black"
                                            Text="{Binding curDiagnosisTreatment.DoctorComments, Mode=TwoWay}"
                                            TextWrapping="Wrap" />
                                        <Border
                                            Grid.Row="10"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Margin="2,7,2,2"
                                            Style="{StaticResource LightBlueBorderStyle}">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Border
                                                    Margin="10,-12,0,0"
                                                    HorizontalAlignment="Left"
                                                    Style="{StaticResource LightBlueBorderStyleNo}">
                                                    <TextBlock
                                                        FontWeight="Bold"
                                                        Foreground="#FF6F8AA9"
                                                        Style="{StaticResource TextBlock.Heading.Group}"
                                                        Text="{Binding T3402_G1_MaICD10, Source={StaticResource eHCMSResources}}" />
                                                </Border>
                                                <customcontrols:AxDataGridNy
                                                    Grid.Row="1"
                                                    Margin="2"
                                                    AutoGenerateColumns="False"
                                                    ColumnHeaderStyle="{StaticResource MainFrame.DataGridColumnHeaderStyle}"
                                                    IsReadOnly="True"
                                                    ItemsSource="{Binding refIDC10List}"
                                                    RowStyle="{StaticResource MainFrame.DataGridRowStyle.Normal}"
                                                    ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                                                    SelectedItem="{Binding refIDC10Item}"
                                                    Style="{StaticResource MainFrame.DataGridStyle}">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Binding="{Binding DiseasesReference.ICD10Code}" Header="{Binding T3185_G1_Ma, Source={StaticResource eHCMSResources}}" />
                                                        <DataGridTextColumn
                                                            MinWidth="150"
                                                            Binding="{Binding DiseasesReference.DiseaseNameVN}"
                                                            Header="{Binding T0829_G1_Ten, Source={StaticResource eHCMSResources}}" />
                                                        <DataGridCheckBoxColumn Binding="{Binding IsMain}" Header="{Binding K1870_G1_Chinh, Source={StaticResource eHCMSResources}}" />
                                                        <DataGridCheckBoxColumn Binding="{Binding IsCongenital}" Header="{Binding K1001_G1_BSinh, Source={StaticResource eHCMSResources}}" />
                                                        <DataGridTextColumn Binding="{Binding LookupStatus.ObjectValue}" Header="{Binding G1319_G1_TTrang, Source={StaticResource eHCMSResources}}" />
                                                    </DataGrid.Columns>
                                                </customcontrols:AxDataGridNy>
                                            </Grid>
                                        </Border>
                                        <Border
                                            Grid.Row="11"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Margin="2,7,2,2"
                                            Style="{StaticResource LightBlueBorderStyle}"
                                            Visibility="{Binding IsHasIcd9, Converter={StaticResource BooleanToVisibility}}">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Border
                                                    Margin="10,-12,0,0"
                                                    HorizontalAlignment="Left"
                                                    Style="{StaticResource LightBlueBorderStyleNo}">
                                                    <TextBlock
                                                        FontWeight="Bold"
                                                        Foreground="#FF6F8AA9"
                                                        Style="{StaticResource TextBlock.Heading.Group}"
                                                        Text="{Binding Z1911_G1_MaICD9, Source={StaticResource eHCMSResources}}" />
                                                </Border>
                                                <DataGrid
                                                    Grid.Row="1"
                                                    Margin="2"
                                                    HorizontalAlignment="Stretch"
                                                    HorizontalContentAlignment="Stretch"
                                                    AutoGenerateColumns="False"
                                                    HeadersVisibility="Column"
                                                    IsReadOnly="True"
                                                    ItemsSource="{Binding CurrentIcd9Collection}"
                                                    SelectionMode="Extended"
                                                    Style="{StaticResource MainFrame.DataGridStyle}">
                                                    <DataGrid.RowStyle>
                                                        <Style BasedOn="{StaticResource MainFrame.DataGridRowStyle.Normal}" TargetType="DataGridRow">
                                                            <Setter Property="Background" Value="White" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding IsMain}" Value="True">
                                                                    <Setter Property="Background" Value="#FA9BE8" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </DataGrid.RowStyle>
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Binding="{Binding RefICD9.ICD9Code}" Header="{Binding T3185_G1_Ma, Source={StaticResource eHCMSResources}}" />
                                                        <DataGridTextColumn Binding="{Binding RefICD9.ProcedureName}" Header="{Binding T0829_G1_Ten, Source={StaticResource eHCMSResources}}" />
                                                        <DataGridCheckBoxColumn Binding="{Binding IsMain}" Header="{Binding K1737_G1_Ch, Source={StaticResource eHCMSResources}}" />
                                                        <DataGridCheckBoxColumn Binding="{Binding IsCongenital}" Header="{Binding Z2318_G1_ManTinhGhiTat, Source={StaticResource eHCMSResources}}" />
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Grid>
                                        </Border>
                                    </Grid>
                                    <!--</Grid>-->
                                </Border>
                            </TabItem>
                            <!--  Toa thuốc  -->
                            <TabItem
                                cal:Message.Attach="[Event Loaded]=[Action TabToaThuoc_Loaded($source)]"
                                Header="{Binding G1434_G1_ToaThuoc, Source={StaticResource eHCMSResources}}"
                                Style="{StaticResource MainFrame.TabItem}"
                                Visibility="{Binding mPrescription, Converter={StaticResource BooleanToVisibility}}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <Button
                                        Name="btnPreviewPrescription"
                                        Grid.Row="0"
                                        Width="75"
                                        Margin="2,1"
                                        HorizontalAlignment="Left"
                                        Content="{Binding G2521_G1_XemIn, Source={StaticResource eHCMSResources}}"
                                        FontWeight="Normal"
                                        Style="{StaticResource MainFrame.Button}" />

                                    <ListView
                                        Grid.Row="1"
                                        Height="Auto"
                                        MinHeight="300"
                                        MaxHeight="550"
                                        VerticalAlignment="Top"
                                        HorizontalContentAlignment="Stretch"
                                        VerticalContentAlignment="Stretch"
                                        ItemsSource="{Binding allPrescription, Mode=OneWay}"
                                        Visibility="{Binding mPrescription, Converter={StaticResource BooleanToVisibility}}">
                                        <ListView.ItemTemplate>
                                            <ItemContainerTemplate>
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Grid.Row="0" Text="{Binding G0696_G1_TTinToaThuoc, Source={StaticResource eHCMSResources}}" />
                                                    <!--<Image
                                                    Grid.Row="2"
                                                    Width="100"
                                                    Height="65"
                                                    Margin="10,0,0,0"
                                                    HorizontalAlignment="Left"
                                                    Source="/aEMR.CommonViews;component/Assets/Images/Drug.png" />-->
                                                    <StackPanel Grid.Row="1" Orientation="Horizontal">
                                                        <TextBlock Text="{Binding Z0297_G1_ToaThuocID, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" />
                                                        <TextBlock
                                                            Margin="10,0,0,0"
                                                            Style="{StaticResource TBlock.Content.00}"
                                                            Text="{Binding PrescriptID}"
                                                            TextWrapping="NoWrap" />
                                                    </StackPanel>
                                                    <StackPanel Grid.Row="3" Orientation="Horizontal">
                                                        <TextBlock Text="{Binding K0961_G1_BSi, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" />
                                                        <TextBlock
                                                            Margin="10,0,0,0"
                                                            FontWeight="Bold"
                                                            Foreground="Red"
                                                            Style="{StaticResource TBlock.Content.00}"
                                                            Text="{Binding ObjIssuerStaffID.FullName}"
                                                            TextWrapping="Wrap" />
                                                    </StackPanel>
                                                    <TextBlock Grid.Row="4" Text="{Binding K1746_G1_CDoan, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" />
                                                    <TextBox
                                                        Grid.Row="5"
                                                        Grid.Column="1"
                                                        MaxHeight="50"
                                                        Margin="0,2,3,2"
                                                        AcceptsReturn="True"
                                                        HorizontalScrollBarVisibility="Auto"
                                                        IsReadOnly="True"
                                                        Style="{StaticResource MainFrame.TextBox}"
                                                        TabIndex="3"
                                                        Text="{Binding Diagnosis}"
                                                        VerticalScrollBarVisibility="Visible" />
                                                    <TextBlock Grid.Row="6" Text="{Binding G0696_G1_TTinToaThuoc, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" />
                                                    <!--<StackPanel
                                                        Grid.Row="7"
                                                        cal:Message.Attach="[Event Loaded]=[Action Grid_Loaded($source)]"
                                                        Visibility="{Binding PrescriptDetailsStr, Converter={StaticResource IfNotNullVisibilityConverter}}" />-->
                                                    <DataGrid
                                                        Grid.Row="7"
                                                        HorizontalAlignment="Stretch"
                                                        HorizontalContentAlignment="Stretch"
                                                        cal:Message.Attach="[Event LoadingRow] = [Action grdPrescription_LoadingRow($source, $eventArgs)]"
                                                        AutoGenerateColumns="False"
                                                        HeadersVisibility="All"
                                                        IsReadOnly="True"
                                                        ItemsSource="{Binding PrescriptionDetails}"
                                                        Style="{StaticResource MainFrame.DataGridStyle}"
                                                        Visibility="{Binding PrescriptionDetails, Converter={StaticResource IfNotNullVisibilityConverter}}">
                                                        <DataGrid.Columns>
                                                            <DataGridTextColumn Binding="{Binding BrandName}" Header="{Binding G0787_G1_Thuoc, Source={StaticResource eHCMSResources}}" />
                                                            <DataGridTextColumn Binding="{Binding Content}" Header="{Binding T1316_G1_HLg, Source={StaticResource eHCMSResources}}" />
                                                            <DataGridTextColumn Binding="{Binding UnitName}" Header="{Binding K3966_G1_Dvt, Source={StaticResource eHCMSResources}}" />
                                                            <DataGridTextColumn Binding="{Binding UnitUse}" Header="{Binding K3960_G1_Dvd, Source={StaticResource eHCMSResources}}" />
                                                            <DataGridTextColumn Binding="{Binding MDoseStr, StringFormat='{}{0}'}" Header="{Binding S0540_G1_Sang, Source={StaticResource eHCMSResources}}" />
                                                            <DataGridTextColumn Binding="{Binding ADoseStr}" Header="{Binding G1808_G1_Trua, Source={StaticResource eHCMSResources}}" />
                                                            <DataGridTextColumn Binding="{Binding EDoseStr}" Header="{Binding K1860_G1_Chieu, Source={StaticResource eHCMSResources}}" />
                                                            <DataGridTextColumn Binding="{Binding NDoseStr}" Header="{Binding G1446_G1_Toi, Source={StaticResource eHCMSResources}}" />
                                                            <DataGridTextColumn Binding="{Binding DayRpts}" Header="{Binding N0045_G1_Ng, Source={StaticResource eHCMSResources}}" />
                                                            <DataGridTextColumn Binding="{Binding Qty}" Header="{Binding S0656_G1_SLgg, Source={StaticResource eHCMSResources}}" />
                                                            <DataGridTextColumn Binding="{Binding Administration}" Header="{Binding K1503_G1_CachDung, Source={StaticResource eHCMSResources}}" />
                                                            <DataGridTextColumn Binding="{Binding DrugInstructionNotes}" Header="{Binding G1183_G1_Ghichu, Source={StaticResource eHCMSResources}}" />
                                                        </DataGrid.Columns>
                                                    </DataGrid>
                                                    <TextBlock Grid.Row="8" Text="{Binding T2921_G1_LoiKhuyen, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" />
                                                    <TextBlock
                                                        Grid.Row="9"
                                                        Margin="10,0,0,0"
                                                        Style="{StaticResource TBlock.Content.00}"
                                                        Text="{Binding DoctorAdvice}"
                                                        TextWrapping="Wrap" />
                                                </Grid>
                                            </ItemContainerTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>
                                </Grid>

                            </TabItem>
                            <!--  Xét nghiệm  -->
                            <TabItem
                                cal:Message.Attach="[Event Loaded]=[Action TabPCL_Loaded($source)]"
                                Header="Cận Lâm Sàng Laboratory"
                                Style="{StaticResource MainFrame.TabItem}"
                                Visibility="{Binding mPCL, Converter={StaticResource BooleanToVisibility}}">

                                <!--<ContentControl
                                        Grid.Row="2"
                                        Grid.Column="0"

                                        Grid.ColumnSpan="3"
                                        HorizontalContentAlignment="Stretch"
                                        VerticalContentAlignment="Stretch"
                                        Visibility="{Binding mPCL, Converter={StaticResource BooleanToVisibility}}">-->
                                <Border
                                    Width="Auto"
                                    Margin="1,1,1,1"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch"
                                    Style="{StaticResource LightBlueBorderStyle}">
                                    <Grid
                                        Width="Auto"
                                        Height="Auto"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Stretch"
                                        ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                        ScrollViewer.VerticalScrollBarVisibility="Auto"
                                        ShowGridLines="False">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="25" />
                                            <RowDefinition Height="25" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>
                                        <TextBlock
                                            Grid.Row="0"
                                            Height="18"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Foreground="#990066"
                                            Style="{StaticResource TextBlock.Heading.02}"
                                            Text="{Binding Z0254_G1_KQuaCLS, Source={StaticResource eHCMSResources}}" />
                                        <Button
                                            Name="btnViewPrintLab"
                                            Grid.Row="1"
                                            Width="75"
                                            Margin="2,1"
                                            HorizontalAlignment="Left"
                                            Content="{Binding G2521_G1_XemIn, Source={StaticResource eHCMSResources}}"
                                            FontWeight="Normal"
                                            Style="{StaticResource MainFrame.Button}" />
                                        <DataGrid
                                            x:Name="gridLaboratory"
                                            Grid.Row="2"
                                            MinWidth="500"
                                            VerticalAlignment="Top"
                                            AutoGenerateColumns="False"
                                            ColumnHeaderStyle="{StaticResource MainFrame.DataGridColumnHeaderStyle}"
                                            HorizontalScrollBarVisibility="Auto"
                                            IsReadOnly="True"
                                            ItemsSource="{Binding allPatientPCLLaboratoryResultDetail, Mode=TwoWay}"
                                            RowHeaderStyle="{StaticResource MainFrame.DataGridRowHeaderStyle}"
                                            RowStyle="{StaticResource MainFrame.DataGridRowStyle.Normal}"
                                            Style="{StaticResource MainFrame.DataGridStyle}"
                                            VerticalScrollBarVisibility="Auto">
                                            <DataGrid.Columns>
                                                <DataGridTemplateColumn
                                                    MinWidth="150"
                                                    CellTemplate="{StaticResource CTtblName}"
                                                    Header="{Binding T0912_G1_TenXetNghiem, Source={StaticResource eHCMSResources}}" />
                                                <DataGridTemplateColumn
                                                    MinWidth="100"
                                                    CellTemplate="{StaticResource DTtxtValue}"
                                                    Header="{Binding T2055_G1_KQua, Source={StaticResource eHCMSResources}}" />
                                                <DataGridTextColumn
                                                    MinWidth="80"
                                                    Binding="{Binding PCLExamTestItemUnit, Mode=TwoWay}"
                                                    Header="{Binding K3681_G1_DVi, Source={StaticResource eHCMSResources}}" />
                                                <DataGridTextColumn
                                                    MinWidth="100"
                                                    Binding="{Binding PCLExamTestItemRefScale, Mode=TwoWay}"
                                                    Header="{Binding G1782_G1_TriSoThamChieu, Source={StaticResource eHCMSResources}}" />
                                                <DataGridTemplateColumn
                                                    MinWidth="100"
                                                    CellTemplate="{StaticResource DTtxtValue_Old}"
                                                    Header="{Binding T2068_G1_KQuaCu, Source={StaticResource eHCMSResources}}" />
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Border>
                                <!--</ContentControl>-->
                            </TabItem>
                            <!--  Hình ảnh mẫu mới  -->
                            <TabItem
                                cal:Message.Attach="[Event Loaded]=[Action TabHinhAnhPCL_New_Loaded($source)]"
                                Header="{Binding TitleReport}"
                                Style="{StaticResource MainFrame.TabItem}"
                                Visibility="{Binding mPCLImage_New, Converter={StaticResource BooleanToVisibility}}">
                                <dxp:DocumentPreviewControl
                                    Grid.Column="1"
                                    Width="Auto"
                                    Height="Auto"
                                    MaxHeight="800"
                                    AutoShowParametersPanel="False"
                                    DocumentSource="{Binding ReportModel, Mode=OneWay}" />
                            </TabItem>
                            <!--  Hình ảnh mẫu cũ  -->
                            <TabItem
                                cal:Message.Attach="[Event Loaded]=[Action TabHinhAnhPCL_Loaded($source)]"
                                Header="Cận Lâm Sàng Imaging"
                                Style="{StaticResource MainFrame.TabItem}"
                                Visibility="{Binding mPCLImage, Converter={StaticResource BooleanToVisibility}}">
                                <ContentControl
                                    x:Name="PCLOldView"
                                    HorizontalContentAlignment="Stretch"
                                    VerticalContentAlignment="Stretch"
                                    Visibility="{Binding mPCLImage, Converter={StaticResource BooleanToVisibility}}" />
                                <!--<wv2:WebView2
                                        Name="webView"
                                        Height="800"
                                        cal:Message.Attach="[Event Loaded]=[Action WebView_Loaded($source,$eventArgs)];"
                                        IsEnabled="False" />-->
                                <!--<ContentControl
                                        x:Name="UCPatientPCLGeneralResult"
                                        HorizontalContentAlignment="Stretch"
                                        VerticalContentAlignment="Stretch" />-->
                            </TabItem>
                            <!--  View PDF File  -->
                            <TabItem
                                cal:Message.Attach="[Event Loaded]=[Action TabPDFView_Loaded($source)]"
                                Header="Cận Lâm Sàng"
                                Style="{StaticResource MainFrame.TabItem}"
                                Visibility="{Binding mPDFView, Converter={StaticResource BooleanToVisibility}}">
                                <dxpdf:PdfViewerControl
                                    x:Name="PDFViewer"
                                    Width="870"
                                    Height="700"
                                    DetachStreamOnLoadComplete="True"
                                    DocumentSource="{Binding PDFViewerSource, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                            </TabItem>
                            <!--  Webview xem hình ảnh từ PAC GE  -->
                            <TabItem
                                HorizontalAlignment="Center"
                                VerticalContentAlignment="Center"
                                Header="Hình ảnh từ PAC"
                                Style="{StaticResource MainFrame.TabItem}"
                                Visibility="{Binding IsShowViewerImageResultFromPAC, Converter={StaticResource VisibilityConverter}}">
                                <wv2:WebView2
                                    Name="webView"
                                    Width="850"
                                    Height="700"
                                    MaxHeight="800"
                                    Source="{Binding SourceLink, Mode=TwoWay}" />
                            </TabItem>
                            <!--<TabItem Header="Cận Lâm Sàng Imaging" Style="{StaticResource MainFrame.TabItem}"
                                         x:Name="TabHinhAnhCLS"
                                         cal:Message.Attach="[Event Loaded]=[Action TabHinhAnhPCL_Loaded($source)]"
                                         Visibility="{Binding mPCLImage,Converter={StaticResource BooleanToVisibility}}">
                                        <ContentControl Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3"  HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"
                                                        x:Name="PCLDepartmentContent"
                                                        >

                                        </ContentControl>
                                    </TabItem>-->
                            <!--<TabItem
                                    cal:Message.Attach="[Event Loaded]=[Action TabNoiTru_Loaded($source)]"
                                    Header="{Binding T3713_G1_NoiTru, Source={StaticResource eHCMSResources}}"
                                    Style="{StaticResource MainFrame.TabItem}"
                                    Visibility="{Binding mNoiTru, Converter={StaticResource BooleanToVisibility}}">
                                    <ContentControl
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="3"
                                        HorizontalContentAlignment="Stretch"
                                        VerticalContentAlignment="Stretch"
                                        Visibility="{Binding mNoiTru, Converter={StaticResource BooleanToVisibility}}">
                                        <Border
                                            Grid.Row="4"
                                            Grid.Column="1"
                                            Width="Auto"
                                            Margin="1,1,1,1"
                                            VerticalAlignment="Stretch"
                                            Style="{StaticResource LightBlueBorderStyle}">
                                            <Grid
                                                Width="Auto"
                                                Height="Auto"
                                                HorizontalAlignment="Stretch"
                                                VerticalAlignment="Stretch"
                                                ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                                ScrollViewer.VerticalScrollBarVisibility="Auto"
                                                ShowGridLines="False">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="131*" />
                                                    <ColumnDefinition Width="8*" />
                                                    <ColumnDefinition Width="394*" />
                                                    <ColumnDefinition Width="49*" />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="25" />
                                                    <RowDefinition Height="25" />
                                                    <RowDefinition Height="25" MinHeight="25" />
                                                    <RowDefinition Height="25" MinHeight="25" />
                                                    <RowDefinition Height="25" MinHeight="25" />
                                                    <RowDefinition Height="25" MinHeight="25" />
                                                    <RowDefinition Height="25" MinHeight="25" />
                                                    <RowDefinition Height="25" MinHeight="25" />
                                                    <RowDefinition Height="25" MinHeight="25" />
                                                    <RowDefinition Height="25" MinHeight="25" />
                                                    <RowDefinition Height="25" MinHeight="25" />
                                                </Grid.RowDefinitions>
                                                <TextBlock
                                                    Grid.Column="2"
                                                    Height="18"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    Foreground="#990066"
                                                    Style="{StaticResource TextBlock.Heading.02}"
                                                    Text="{Binding Z0274_G1_TTinNoiTru, Source={StaticResource eHCMSResources}}" />
                                                <Label
                                                    Grid.Row="1"
                                                    Grid.Column="0"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Content="{Binding T0834_G1_TenBenhNhan, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}"
                                                    Style="{StaticResource MainFrame.Label.00}" />
                                                <Label
                                                    Grid.Row="2"
                                                    Grid.Column="0"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Content="{Binding T3312_G1_MaDK, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}"
                                                    Style="{StaticResource MainFrame.Label.00}" />
                                                <Label
                                                    Grid.Row="3"
                                                    Grid.Column="0"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Content="{Binding N0096_G1_NgNhapVien, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}"
                                                    Style="{StaticResource MainFrame.Label.00}" />
                                                <Label
                                                    Grid.Row="4"
                                                    Grid.Column="0"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Content="{Binding T3163_G1_LyDoNhVien, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}"
                                                    Style="{StaticResource MainFrame.Label.00}" />
                                                <Label
                                                    Grid.Row="5"
                                                    Grid.Column="0"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Content="{Binding Z0265_G1_GChuNV, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}"
                                                    Style="{StaticResource MainFrame.Label.00}" />
                                                <Label
                                                    Grid.Row="6"
                                                    Grid.Column="0"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Content="{Binding N0132_G1_NgXuatVien, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}"
                                                    Style="{StaticResource MainFrame.Label.00}" />
                                                <Label
                                                    Grid.Row="7"
                                                    Grid.Column="0"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Content="Lý Do Xuất Viện:"
                                                    Style="{StaticResource MainFrame.Label.00}" />
                                                <Label
                                                    Grid.Row="8"
                                                    Grid.Column="0"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Content="Ghi Chú Xuất Viện:"
                                                    Style="{StaticResource MainFrame.Label.00}" />
                                                <TextBlock
                                                    Grid.Row="1"
                                                    Grid.Column="2"
                                                    Height="22"
                                                    Style="{StaticResource TextBlock.Heading.04}"
                                                    Text="{Binding curPatient.FullName, Mode=OneWay}"
                                                    TextWrapping="Wrap" />
                                                <TextBlock
                                                    Grid.Row="2"
                                                    Grid.Column="2"
                                                    Height="22"
                                                    Style="{StaticResource TextBlock.Heading.04}"
                                                    Text="{Binding curInPatientAdmDisDetails.PtRegistrationID, Mode=OneWay}"
                                                    TextWrapping="Wrap" />
                                                <TextBlock
                                                    Grid.Row="3"
                                                    Grid.Column="2"
                                                    Height="22"
                                                    Style="{StaticResource TextBlock.Heading.04}"
                                                    Text="{Binding curInPatientAdmDisDetails.AdmissionDate, StringFormat='dd/MM/yyyy', Mode=OneWay}"
                                                    TextWrapping="Wrap" />
                                                <TextBlock
                                                    Grid.Row="4"
                                                    Grid.Column="2"
                                                    Height="22"
                                                    Style="{StaticResource TextBlock.Heading.04}"
                                                    Text="{Binding curInPatientAdmDisDetails.VAdmissionType.ObjectValue, Mode=OneWay}"
                                                    TextWrapping="Wrap" />
                                                <TextBlock
                                                    Grid.Row="5"
                                                    Grid.Column="2"
                                                    Height="22"
                                                    Style="{StaticResource TextBlock.Heading.04}"
                                                    Text="{Binding curInPatientAdmDisDetails.AdmissionNote, Mode=OneWay}"
                                                    TextWrapping="Wrap" />
                                                <TextBlock
                                                    Grid.Row="6"
                                                    Grid.Column="2"
                                                    Height="22"
                                                    Style="{StaticResource TextBlock.Heading.04}"
                                                    Text="{Binding curInPatientAdmDisDetails.DischargeDate, StringFormat='dd/MM/yyyy', Mode=OneWay}"
                                                    TextWrapping="Wrap" />
                                                <TextBlock
                                                    Grid.Row="7"
                                                    Grid.Column="2"
                                                    Height="22"
                                                    Style="{StaticResource TextBlock.Heading.04}"
                                                    Text="{Binding curInPatientAdmDisDetails.VDischargeType.ObjectValue, Mode=OneWay}"
                                                    TextWrapping="Wrap" />
                                                <TextBlock
                                                    Grid.Row="8"
                                                    Grid.Column="2"
                                                    Height="22"
                                                    Style="{StaticResource TextBlock.Heading.04}"
                                                    Text="{Binding curInPatientAdmDisDetails.DischargeNote, Mode=OneWay}"
                                                    TextWrapping="Wrap" />
                                            </Grid>
                                        </Border>
                                    </ContentControl>
                                </TabItem>-->
                            <TabItem
                                cal:Message.Attach="[Event Loaded]=[Action TabCLSHinhAnhNgoaiVien_Loaded($source)]"
                                Header="Cận Lâm Sàng Hình Ảnh Ngoại Viện"
                                Style="{StaticResource MainFrame.TabItem}"
                                Visibility="{Binding mCLSHinhAnhNgoaiVien, Converter={StaticResource BooleanToVisibility}}">
                                <ContentControl
                                    x:Name="CLSHinhAnhNgoaiVien"
                                    HorizontalContentAlignment="Stretch"
                                    VerticalContentAlignment="Stretch"
                                    Visibility="{Binding mCLSHinhAnhNgoaiVien, Converter={StaticResource BooleanToVisibility}}" />
                            </TabItem>
                            <!--  Thủ thuật  -->
                            <TabItem
                                cal:Message.Attach="[Event Loaded]=[Action TabThuThuat_Loaded($source)]"
                                Header="Thủ thuật"
                                Style="{StaticResource MainFrame.TabItem}"
                                Visibility="{Binding mSmallProcedure, Converter={StaticResource BooleanToVisibility}}">
                                <ContentControl
                                    x:Name="ThuThuatView"
                                    HorizontalContentAlignment="Stretch"
                                    VerticalContentAlignment="Stretch"
                                    Visibility="{Binding mSmallProcedure, Converter={StaticResource BooleanToVisibility}}" />
                            </TabItem>
                        </TabControl>
                        <!--</Grid>-->
                        <!--</xctk:BusyIndicator>-->
                    </DockPanel>
                </Grid>
            </Grid>
        </xctk:BusyIndicator>
    </Border>
</UserControl>
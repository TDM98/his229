<UserControl
    x:Class="aEMR.Common.Views.PatientHiManagementView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Resources="clr-namespace:eHCMSLanguage;assembly=aEMRLanguage"
    xmlns:aEMRCommConv="clr-namespace:aEMR.Common.Converters;assembly=aEMR.Common"
    xmlns:cal="http://www.caliburnproject.org"
    xmlns:customcontrols="clr-namespace:aEMR.Controls;assembly=aEMR.Controls"
    xmlns:my="clr-namespace:aEMR.Common.Views"
    xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit">
    <UserControl.Resources>
        <Resources:eHCMSResources x:Key="eHCMSResources" />
        <BooleanToVisibilityConverter x:Key="BooleanToVisibility" />
        <DataTemplate x:Key="gridHI_HiInfoTemplate">
            <my:UCHealthInsuranceInfo HorizontalAlignment="Left" VerticalAlignment="Top" />
        </DataTemplate>
        <aEMRCommConv:EnumConverter x:Key="EnumConverterObj" />
        <aEMRCommConv:ShortDateConverter x:Key="ShortDateConverter" />
        <aEMRCommConv:VisibilityConverter x:Key="VisibilityConverter" />
        <aEMRCommConv:InverseBoolConverter x:Key="InverseBoolConverter" />
        <aEMRCommConv:ValueNotNullToVisibilityConverter x:Key="ValueNotNullToVisibilityConverter" />
    </UserControl.Resources>
    <xctk:BusyIndicator BusyContent="{Binding DlgBusyContent}" IsBusy="{Binding DlgIsBusyFlag}">
        <Grid Name="LayoutRoot">
            <Grid x:Name="panelHI" Margin="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" MinHeight="24" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="75*" />
                    <ColumnDefinition Width="45*" />
                </Grid.ColumnDefinitions>
                <customcontrols:AxDataGrid
                    x:Name="gridHIItems"
                    MaxHeight="150"
                    Margin="5,0,5,0"
                    cal:Message.Attach="[Event MouseDoubleClick]=[Action GridHIItems_MouseDoubleClick($source,$eventArgs)]"
                    AutoGenerateColumns="False"
                    CanUserAddRows="False"
                    HeadersVisibility="None"
                    HorizontalScrollBarVisibility="Disabled"
                    IsEnabled="{Binding CanSelectHiItem, Mode=OneWay}"
                    IsReadOnly="True"
                    ItemsSource="{Binding HealthInsurances, Mode=OneWay}"
                    SelectedItem="{Binding SelectedHiItem, Mode=TwoWay}"
                    Style="{StaticResource MainFrame.AxDataGridStyle.Common}">
                    <DataGrid.Columns>
                        <!--<DataGridTemplateColumn CellTemplate="{StaticResource gridHI_CheckTemplate}" Width="35" IsReadOnly="True" />-->
                        <DataGridTemplateColumn Width="*" CellTemplate="{StaticResource gridHI_HiInfoTemplate}" />
                    </DataGrid.Columns>
                </customcontrols:AxDataGrid>
                <Grid Grid.Row="1" Margin="5,0,5,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Border
                        Grid.ColumnSpan="2"
                        Margin="0,50,0,0"
                        Padding="5,0,5,0"
                        HorizontalAlignment="Stretch"
                        BorderThickness="1"
                        Style="{StaticResource LightBlueBorderStyle}">
                        <StackPanel>
                            <StackPanel>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="24" />
                                        <RowDefinition Height="24" />
                                        <RowDefinition Height="24" />
                                        <RowDefinition Height="24" />
                                        <RowDefinition Height="24" />
                                    </Grid.RowDefinitions>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="35" />
                                            <ColumnDefinition Width="140" />
                                            <ColumnDefinition Width="30" />
                                            <ColumnDefinition Width="160" />
                                            <ColumnDefinition Width="50" />
                                            <ColumnDefinition Width="75" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TBlock.Heading.02.RightAlignment}"
                                            Text="{Binding T2669_G1_Loai, Source={StaticResource eHCMSResources}}" />
                                        <customcontrols:AxComboBox
                                            x:Name="cboCardType"
                                            Grid.Column="1"
                                            Width="140"
                                            HorizontalAlignment="Left"
                                            DisplayMemberPath="ObjectValue"
                                            IsEnabled="{Binding CanEditHiInfo, Mode=OneWay}"
                                            ItemsSource="{Binding HiCardTypes, Mode=OneWay}"
                                            SelectedItemEx="{Binding EditingHiItem.HICardType, Mode=TwoWay}"
                                            SelectedValuePath="LookupID"
                                            Style="{StaticResource MainFrame.ComboBox}" />
                                        <TextBlock
                                            x:Name="lblCardType"
                                            Grid.Column="1"
                                            Width="140"
                                            Style="{StaticResource TBlock.Content.02.LeftAlignment}"
                                            Text="{Binding EditingHiItem.HICardType.ObjectValue, Mode=OneWay}" />
                                        <TextBlock
                                            Grid.Column="2"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TBlock.Heading.02.RightAlignment}"
                                            Text="{Binding T3185_G1_Ma, Source={StaticResource eHCMSResources}}" />
                                        <customcontrols:AxTextBoxHICard
                                            x:Name="txtHICardNo"
                                            Grid.Column="3"
                                            MinWidth="150"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            cal:Message.Attach="[Event LostFocus]=[Action txtHICardNo_LostFocus($source,$eventArgs)]"
                                            IsEnabled="{Binding CanEditHiInfo, Mode=OneWay}"
                                            Text="{Binding EditingHiItem.HICardNo, Mode=TwoWay, NotifyOnValidationError=True, ValidatesOnExceptions=True}"
                                            TextLength="{Binding TextLength, Mode=TwoWay}" />
                                        <TextBlock
                                            x:Name="lblHICardNo"
                                            Grid.Column="3"
                                            MinWidth="150"
                                            Margin="0,0,10,0"
                                            Style="{StaticResource TBlock.Content.02.LeftAlignment}"
                                            Text="{Binding EditingHiItem.HICardNo, Mode=OneWay}" />
                                        <TextBlock
                                            Grid.Column="4"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TBlock.Heading.02.RightAlignment}"
                                            Text="{Binding T2010_G1_KCBBD, Source={StaticResource eHCMSResources}}" />
                                        <TextBlock
                                            x:Name="lblRegistrationCode"
                                            Grid.Column="5"
                                            MinWidth="75"
                                            Style="{StaticResource TBlock.Content.02.LeftAlignment}"
                                            Text="{Binding EditingHiItem.RegistrationCode, Mode=OneWay}" />
                                        <TextBox
                                            x:Name="txtRegistrationCode"
                                            Grid.Column="5"
                                            MinWidth="75"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            cal:Message.Attach="[Event LostFocus]=[Action txtRegistrationCode_LostFocus($source,$eventArgs)]"
                                            IsEnabled="{Binding CanEditHiInfo, Mode=OneWay}"
                                            MaxLength="5"
                                            Text="{Binding EditingHiItem.RegistrationCode, Mode=OneWay}" />
                                    </Grid>
                                    <Grid Grid.Row="1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="35" />
                                            <ColumnDefinition MaxWidth="465" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TBlock.Heading.02.RightAlignment}"
                                            Text="{Binding T2009_G1_KCB, Source={StaticResource eHCMSResources}}" />
                                        <ContentControl
                                            Name="HospitalAutoCompleteContent"
                                            Grid.Column="1"
                                            MaxWidth="450"
                                            HorizontalContentAlignment="Stretch"
                                            VerticalContentAlignment="Stretch"
                                            IsEnabled="{Binding CanEditHiInfo, Mode=OneWay}" />
                                        <TextBlock
                                            x:Name="lblRegistrationLocation"
                                            Grid.Column="1"
                                            MaxWidth="450"
                                            Style="{StaticResource TBlock.Content.02.LeftAlignment}"
                                            Text="{Binding EditingHiItem.RegistrationLocation, Mode=OneWay}" />
                                    </Grid>
                                    <Grid Grid.Row="2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="35" />
                                            <ColumnDefinition Width="200" />
                                            <ColumnDefinition Width="35" />
                                            <ColumnDefinition Width="90" />
                                            <ColumnDefinition Width="40" />
                                            <ColumnDefinition Width="90" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TBlock.Heading.02.RightAlignment}"
                                            Text="{Binding T0755_G1_TTh, Source={StaticResource eHCMSResources}}" />
                                        <TextBox
                                            x:Name="txtKCBBDCountry"
                                            Grid.Column="1"
                                            MinWidth="195"
                                            HorizontalAlignment="Stretch"
                                            VerticalContentAlignment="Center"
                                            IsEnabled="False"
                                            Text="{Binding EditingHiItem.CityProvinceName, Mode=TwoWay}" />
                                        <TextBlock
                                            Grid.Column="2"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TBlock.Heading.02.RightAlignment}"
                                            Text="{Binding G1883_G1_Tu, Source={StaticResource eHCMSResources}}" />
                                        <customcontrols:AxDateTextBox
                                            x:Name="txtValidDateFrom"
                                            Grid.Column="3"
                                            Width="90"
                                            HorizontalAlignment="Stretch"
                                            VerticalContentAlignment="Center"
                                            cal:Message.Attach="[Event Loaded]=[Action DateFrom_Loaded($source, $eventArgs)];                                                                       [Event LostFocus]=[Action DateFrom_LostFocus($source,$eventArgs)]"
                                            IsEnabled="{Binding CanEditHiInfo, Mode=OneWay}"
                                            Text="{Binding EditingHiItem.ValidDateFrom, Mode=TwoWay, NotifyOnValidationError=True, Converter={StaticResource ShortDateConverter}}" />
                                        <TextBlock
                                            x:Name="lblValidDateFrom"
                                            Grid.Column="3"
                                            MinWidth="90"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TBlock.Content.02.LeftAlignment}"
                                            Text="{Binding EditingHiItem.ValidDateFrom, Mode=TwoWay, Converter={StaticResource ShortDateConverter}}" />
                                        <TextBlock
                                            Grid.Column="4"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TBlock.Heading.02.RightAlignment}"
                                            Text="{Binding K3184_G1_Den, Source={StaticResource eHCMSResources}}" />
                                        <customcontrols:AxDateTextBox
                                            x:Name="txtValidDateTo"
                                            Grid.Column="5"
                                            Width="90"
                                            HorizontalAlignment="Stretch"
                                            VerticalContentAlignment="Center"
                                            cal:Message.Attach="[Event Loaded]=[Action DateTo_Loaded($source, $eventArgs)];                                                                       [Event LostFocus]=[Action DateTo_LostFocus($source,$eventArgs)]"
                                            IsEnabled="{Binding CanEditHiInfo, Mode=OneWay}"
                                            IsTabStop="False"
                                            Text="{Binding EditingHiItem.ValidDateTo, Mode=TwoWay, NotifyOnValidationError=True, Converter={StaticResource ShortDateConverter}, UpdateSourceTrigger=Explicit}" />
                                        <TextBlock
                                            x:Name="lblValidDateTo"
                                            Grid.Column="5"
                                            MinWidth="90"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TBlock.Content.02.LeftAlignment}"
                                            Text="{Binding EditingHiItem.ValidDateTo, Mode=OneWay, Converter={StaticResource ShortDateConverter}}" />
                                    </Grid>
                                    <Grid Grid.Row="3">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="35" />
                                            <ColumnDefinition Width="425" />
                                            <ColumnDefinition Width="30" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TextBlock.Heading.04}"
                                            Text="{Binding K2757_G1_DChi, Source={StaticResource eHCMSResources}}"
                                            TextWrapping="Wrap" />
                                        <TextBox
                                            Grid.Column="1"
                                            Height="22"
                                            VerticalAlignment="Center"
                                            VerticalContentAlignment="Center"
                                            IsEnabled="{Binding CanEditAddressForHICard, Mode=OneWay}"
                                            IsReadOnly="{Binding Path=FormState, ConverterParameter=NONE|READONLY, Mode=OneWay, Converter={StaticResource EnumConverterObj}}"
                                            Style="{StaticResource MainFrame.TextBox}"
                                            Text="{Binding EditingHiItem.PatientStreetAddress, Mode=TwoWay, NotifyOnValidationError=True, ValidatesOnExceptions=True, UpdateSourceTrigger=PropertyChanged}" />
                                        <Button
                                            Name="LoadAddressFromPatientDetail"
                                            Grid.Column="2"
                                            Content="..."
                                            IsEnabled="{Binding CanEditAddressForHICard, Mode=OneWay}"
                                            IsTabStop="False"
                                            Style="{StaticResource MainFrame.Button}" />
                                    </Grid>
                                    <Grid Grid.Row="4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="35" />
                                            <ColumnDefinition Width="145" />
                                            <ColumnDefinition Width="40" />
                                            <ColumnDefinition Width="115" />
                                            <ColumnDefinition Width="45" />
                                            <ColumnDefinition Width="110" />
                                        </Grid.ColumnDefinitions>
                                        <!--  Text="{Binding EditingHiItem.CityProvinceName_Address, Mode=TwoWay}"  -->
                                        <TextBlock
                                            Margin="0"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TextBlock.Heading.04}"
                                            Text="{Binding G1270_G1_Tinh, Source={StaticResource eHCMSResources}}"
                                            TextWrapping="Wrap" />
                                        <customcontrols:AxAutoComplete
                                            x:Name="AcbHICity"
                                            Grid.Column="1"
                                            Height="22"
                                            VerticalAlignment="Center"
                                            cal:Message.Attach="[Event Loaded]=[Action AcbHICity_Loaded($source, $eventArgs)];                                                                        [Event Populating] = [Action AcbHICity_Populating($source, $eventArgs)];                                                                        [Event DropDownClosed] = [Action AcbHICity_DropDownClosed($source, $eventArgs)]"
                                            FilterMode="None"
                                            FontWeight="Bold"
                                            IsDropDownOpen="True"
                                            IsEnabled="{Binding CanEditAddressForHICard, Mode=OneWay}"
                                            ItemContainerStyle="{StaticResource AxAutoCompleteBoxBkg}"
                                            ItemsSource="{Binding allProvince, Mode=TwoWay}"
                                            MinimumPopulateDelay="300"
                                            MinimumPrefixLength="0"
                                            SelectedItem="{Binding SelectedProvince, Mode=TwoWay}"
                                            Style="{StaticResource AxAutoCompleteMyStyle}"
                                            Text="{Binding TxdText, Mode=TwoWay}"
                                            TextBoxStyle="{StaticResource MainFrame.TextBox}"
                                            ValueMemberBinding="{Binding Path=CityProvinceName, Mode=TwoWay}">
                                            <customcontrols:AxAutoComplete.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Path=CityProvinceName}" />
                                                </DataTemplate>
                                            </customcontrols:AxAutoComplete.ItemTemplate>
                                        </customcontrols:AxAutoComplete>
                                        <TextBlock
                                            Grid.Column="2"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TextBlock.Heading.04}"
                                            Text="{Binding Q0446_G1_Quan, Source={StaticResource eHCMSResources}}"
                                            TextWrapping="Wrap" />
                                        <customcontrols:AxComboBox
                                            x:Name="cboHISuburb"
                                            Grid.Column="3"
                                            Height="22"
                                            VerticalAlignment="Center"
                                            cal:Message.Attach="[Event Loaded]=[Action cboHISuburb_Loaded($source, $eventArgs)];                                                                    [Event GotFocus]=[Action cboHISuburb_GotFocus($source, $eventArgs)];                                                                    [Event SelectionChanged]=[Action cboSuburb_SelectionChanged($source, $eventArgs)]"
                                            DisplayMemberPath="SuburbName"
                                            IsEnabled="{Binding CanEditAddressForHICard, Mode=OneWay}"
                                            ItemsSource="{Binding SuburbNames, Mode=OneWay}"
                                            SelectedValueEx="{Binding EditingHiItem.SuburbNameID, Mode=TwoWay, NotifyOnValidationError=True, ValidatesOnExceptions=True, UpdateSourceTrigger=PropertyChanged}"
                                            SelectedValuePath="SuburbNameID"
                                            Style="{StaticResource MainFrame.ComboBox}" />
                                        <TextBlock
                                            Grid.Column="4"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource TextBlock.Heading.04}"
                                            Text="{Binding Z2336_G1_Phuong, Source={StaticResource eHCMSResources}}"
                                            TextWrapping="Wrap" />
                                        <customcontrols:AxComboBox
                                            x:Name="cboHIWardName"
                                            Grid.Column="5"
                                            Height="22"
                                            VerticalAlignment="Center"
                                            cal:Message.Attach="[Event Loaded]=[Action cboHIWardName_Loaded($source, $eventArgs)]"
                                            DisplayMemberPath="WardName"
                                            IsEnabled="{Binding CanEditAddressForHICard, Mode=OneWay}"
                                            ItemsSource="{Binding ListWardNames, Mode=OneWay}"
                                            SelectedValueEx="{Binding EditingHiItem.WardNameID, Mode=TwoWay, NotifyOnValidationError=True, ValidatesOnExceptions=True, UpdateSourceTrigger=PropertyChanged}"
                                            SelectedValuePath="WardNameID"
                                            Style="{StaticResource MainFrame.ComboBox}" />
                                    </Grid>
                                </Grid>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" MinHeight="24" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="250" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="55" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Style="{StaticResource TBlock.Heading.02.RightAlignment}"
                                        Text="{Binding S0673_G1_SoLuuTru, Source={StaticResource eHCMSResources}}" />
                                    <TextBox
                                        Name="txtArchiveNumber"
                                        Grid.Column="1"
                                        Width="320"
                                        Height="24"
                                        HorizontalAlignment="Left"
                                        VerticalContentAlignment="Center"
                                        Style="{StaticResource MainFrame.TextBox}"
                                        Text="{Binding EditingHiItem.ArchiveNumber, Mode=TwoWay}"
                                        TextAlignment="Left" />
                                    <TextBlock
                                        Name="tblArchiveNumber"
                                        Grid.Column="1"
                                        Width="320"
                                        Margin="0,0,10,0"
                                        Style="{StaticResource TBlock.Content.02.LeftAlignment}"
                                        Text="{Binding EditingHiItem.ArchiveNumber, Mode=OneWay}"
                                        TextAlignment="Left" />
                                    <TextBlock
                                        Grid.Column="4"
                                        Margin="2"
                                        VerticalAlignment="Center"
                                        Style="{StaticResource TBlock.Heading.02.RightAlignment}"
                                        Text="{Binding T2502_G1_KichHoat, Source={StaticResource eHCMSResources}}" />
                                    <CheckBox
                                        x:Name="rdoActiveView"
                                        Grid.Column="5"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        VerticalContentAlignment="Center"
                                        IsChecked="{Binding EditingHiItem.IsActive, Mode=OneWay}"
                                        IsEnabled="False"
                                        Style="{StaticResource MainFrame.Checkbox.Title1}" />
                                    <CheckBox
                                        x:Name="rdoActiveEdit"
                                        Grid.Column="5"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        VerticalContentAlignment="Center"
                                        IsChecked="{Binding EditingHiItem.IsActive, Mode=TwoWay}"
                                        Style="{StaticResource MainFrame.Checkbox.Title1}" />
                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        Style="{StaticResource TBlock.Heading.02.RightAlignment}"
                                        Text="{Binding Z2273_G1_KiemTraTheBHYT, Source={StaticResource eHCMSResources}}"
                                        Visibility="{Binding EditingHiItem.CheckedHICardValidResult, Converter={StaticResource ValueNotNullToVisibilityConverter}}" />
                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        Style="{StaticResource TBlock.Heading.02.RightAlignment}"
                                        Text="{Binding EditingHiItem.CheckedHICardValidResult, Mode=OneWay}"
                                        TextWrapping="Wrap"
                                        Visibility="{Binding EditingHiItem.CheckedHICardValidResult, Converter={StaticResource ValueNotNullToVisibilityConverter}}" />
                                    <TextBlock
                                        Grid.Column="2"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Style="{StaticResource TextBlock.Heading.04}"
                                        Text="{Binding T3406_G1_MaKV, Source={StaticResource eHCMSResources}}"
                                        TextWrapping="Wrap" />
                                    <customcontrols:AxComboBox
                                        x:Name="cboKV"
                                        Grid.Column="3"
                                        Height="22"
                                        VerticalAlignment="Bottom"
                                        IsEnabled="{Binding CanEditAddressForHICard, Mode=OneWay}"
                                        ItemsSource="{Binding AllKVCode, Mode=OneWay}"
                                        SelectedValueEx="{Binding SelectedKV, Mode=TwoWay, NotifyOnValidationError=True, ValidatesOnExceptions=True}"
                                        Style="{StaticResource MainFrame.ComboBox}" />
                                </Grid>
                            </StackPanel>
                            <!--  Visibility="{Binding TheBH_Edit, Converter={StaticResource BooleanToVisibility} }"  -->
                            <StackPanel
                                Margin="5,5,0,5"
                                Orientation="Horizontal"
                                Visibility="{Binding CanEdit, Mode=OneWay, Converter={StaticResource VisibilityConverter}}">
                                <!--  cal:Message.Attach="[Event Click] = [Action BtnRefreshCardList_Click($source, $eventArgs)]"  -->
                                <!--  cal:Message.Attach="[Event Click] = [Action BtnDeleteCard_Click($source, $eventArgs)]"  -->
                                <Button
                                    x:Name="BtnRefreshHICardList"
                                    Margin="0,0,10,0"
                                    IsTabStop="False">
                                    <ToolTipService.ToolTip>
                                        <TextBlock Margin="0,0,0,0" Text="{Binding T2662_G1_Load, Source={StaticResource eHCMSResources}}" />
                                    </ToolTipService.ToolTip>
                                    <Button.Content>
                                        <Image
                                            Width="18"
                                            Height="18"
                                            Opacity="1"
                                            Source="/aEMR.CommonViews;component/Assets/Images/Refresh16.png" />
                                    </Button.Content>
                                </Button>

                                <Button
                                    x:Name="BtnDeleteHICard"
                                    Margin="0,0,18,0"
                                    IsTabStop="False">
                                    <ToolTipService.ToolTip>
                                        <TextBlock Margin="0,0,0,0" Text="{Binding G2617_G1_Xoa, Source={StaticResource eHCMSResources}}" />
                                    </ToolTipService.ToolTip>
                                    <Button.Content>
                                        <Image
                                            Width="18"
                                            Height="18"
                                            Opacity="1"
                                            Source="/aEMR.CommonViews;component/Assets/Images/Delete.png" />
                                    </Button.Content>
                                </Button>

                                <Button
                                    x:Name="CreateNewHiCmd"
                                    Width="80"
                                    Content="{Binding G0276_G1_ThemMoi, Source={StaticResource eHCMSResources}}"
                                    Style="{StaticResource MainFrame.Button}"
                                    Visibility="{Binding ShowCreateNewHiCmd, Mode=OneWay, Converter={StaticResource VisibilityConverter}}" />
                                <Button
                                    x:Name="BeginEditCmd"
                                    Width="80"
                                    Content="{Binding S0739_G1_Sua, Source={StaticResource eHCMSResources}}"
                                    Style="{StaticResource MainFrame.Button}"
                                    Visibility="{Binding ShowBeginEditCmd, Mode=OneWay, Converter={StaticResource VisibilityConverter}}" />
                                <Button
                                    x:Name="BeginEditAfterRegistrationCmd"
                                    Width="97"
                                    Content="{Binding S0741_G1_SuaSauDK, Source={StaticResource eHCMSResources}}"
                                    Style="{StaticResource MainFrame.Button}"
                                    Visibility="{Binding ShowBeginEditAfterRegistrationCmd, Mode=OneWay, Converter={StaticResource VisibilityConverter}}" />
                                <Button
                                    x:Name="SaveHiInfoCmd"
                                    Width="80"
                                    Content="{Binding T2937_G1_Luu, Source={StaticResource eHCMSResources}}"
                                    Style="{StaticResource MainFrame.Button}"
                                    Visibility="{Binding ShowSaveHiInfoCmd, Mode=OneWay, Converter={StaticResource VisibilityConverter}}" />
                                <Button
                                    x:Name="CancelEditCmd"
                                    Width="80"
                                    Content="{Binding K1305_G1_BoQua, Source={StaticResource eHCMSResources}}"
                                    Style="{StaticResource MainFrame.Button}"
                                    Visibility="{Binding ShowCancelEditCmd, Mode=OneWay, Converter={StaticResource VisibilityConverter}}" />
                                <Button
                                    x:Name="SaveHIAndConfirmCmd"
                                    Width="100"
                                    Content="{Binding Z2781_G1_LuuVaXacNhan, Source={StaticResource eHCMSResources}}"
                                    Style="{StaticResource MainFrame.Button}"
                                    Visibility="{Binding ShowSaveHIAndConfirmCmd, Mode=OneWay, Converter={StaticResource VisibilityConverter}}" />
                                <TextBlock
                                    Grid.Column="2"
                                    Margin="2,0,2,0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Style="{StaticResource TextBlock.Heading.04}"
                                    Text="Hình thức tiếp nhận"
                                    TextWrapping="Wrap" />
                                <customcontrols:AxComboBox
                                    Grid.Column="3"
                                    Width="125"
                                    Height="22"
                                    VerticalAlignment="Center"
                                    DisplayMemberPath="ObjectValue"
                                    IsEnabled="{Binding CanEditAddressForHICard, Mode=OneWay}"
                                    ItemsSource="{Binding ReceiveMethod, Mode=OneWay}"
                                    SelectedValueEx="{Binding V_ReceiveMethod, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    SelectedValuePath="LookupID"
                                    Style="{StaticResource MainFrame.ComboBox}" />
                            </StackPanel>
                        </StackPanel>
                    </Border>
                    <CheckBox
                        x:Name="chkIncludeDeletedHIItems"
                        Grid.Row="1"
                        VerticalContentAlignment="Center"
                        Content="{Binding K1089_G1_BaoGomNhungMucDaXoa, Source={StaticResource eHCMSResources}}"
                        IsChecked="{Binding IncludeDeletedItems, Mode=TwoWay}"
                        IsEnabled="{Binding Path=HIItemsChanged, ElementName=PatientDetails, Mode=OneWay, Converter={StaticResource InverseBoolConverter}}"
                        Style="{StaticResource MainFrame.Checkbox.Title1}"
                        Visibility="Collapsed" />
                    <CheckBox
                        x:Name="ConfirmHealthInsuranceSelected"
                        Grid.Row="1"
                        Grid.Column="1"
                        HorizontalAlignment="Right"
                        VerticalContentAlignment="Center"
                        Content="{Binding K2805_G1_DaKTraTheBH, Source={StaticResource eHCMSResources}}"
                        Style="{StaticResource MainFrame.Checkbox.Title1}"
                        Visibility="Collapsed" />
                </Grid>
                <ContentControl
                    x:Name="PaperReferalContent"
                    Grid.RowSpan="2"
                    Grid.Column="1"
                    HorizontalContentAlignment="Stretch"
                    VerticalContentAlignment="Stretch"
                    Visibility="{Binding ShowPaperReferalContent, Mode=OneWay, Converter={StaticResource VisibilityConverter}}" />
            </Grid>
        </Grid>
    </xctk:BusyIndicator>
</UserControl>

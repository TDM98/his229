<UserControl x:Class="aEMR.ClinicManagement.Views.RefMedicalFileCheckOutView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:cal="http://www.caliburnproject.org"
        xmlns:AxControls="clr-namespace:aEMR.Controls;assembly=aEMR.Controls"
        xmlns:Converters="clr-namespace:aEMR.Common.Converters;assembly=aEMR.Common"
        xmlns:AutoBoxTK="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Input.Toolkit"
        xmlns:Resources="clr-namespace:eHCMSLanguage;assembly=aEMRLanguage" 
        d:DesignHeight="1000" d:DesignWidth="1200"
        mc:Ignorable="d" >
    <UserControl.Resources>
	    <Resources:eHCMSResources x:Key="eHCMSResources"/>
        <Converters:WidthConverter x:Key="WidthConverter"/>
        <Converters:StringFormatConverter x:Key="StringFormatConverter"/>
        <Converters:NullRefShelfNameConverter x:Key="NullRefShelfNameConverter"/>
        <Converters:BooleanToVisibilityNotConverter x:Key="BooleanToVisibilityNot"/>
        <Converters:BooleanToVisibilityConverter x:Key="BooleanToVisibility" />
        <Converters:EnumFileStorageStatusToBooleanConverter x:Key="EnumFileStorageStatusToBoolean"/>
        <DataTemplate x:Key="gvColumn_lnkDelete">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Button x:Name="lnkDelete" 
                        Style="{StaticResource MainFrame.HyperlinkButton.01}"
                        ToolTipService.ToolTip="Click here for delete" cal:Message.Attach="[Event Click]=[Action lnkDelete_Click($source,$eventArgs)]">
                    <Button.Content>
                        <Image Source="/aEMR.CommonViews;component/Assets/Images/Delete.png" Height="13" Width="13" Opacity="1" />
                    </Button.Content>
                </Button>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="AutoCompleteTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding FullName}" Style="{StaticResource MainFrame.TextBlock.Auto}" Margin="0" Padding="0" />
            </StackPanel>
        </DataTemplate>
    </UserControl.Resources>
    <!--TTM-->
    <!--<toolkit:BusyIndicator Grid.Row="1" IsBusy="{Binding IsBusy}" BusyContent="{Binding BusyMessage}">-->
    <Grid x:Name="LayoutRoot" MaxWidth="{Binding MaxWidth,Mode=OneWay,Converter={StaticResource WidthConverter}}">
        <Grid.RowDefinitions>
            <RowDefinition Height="30"></RowDefinition>
            <RowDefinition></RowDefinition>
        </Grid.RowDefinitions>
        <StackPanel Grid.Row="0" HorizontalAlignment="Stretch" Margin="0,5,0,0">
            <TextBlock FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"
                Text="{Binding TitleForm}" Style="{StaticResource TextBlock.Heading.02}" Foreground="#3595CB"/>
        </StackPanel>
        <Grid Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="40"></RowDefinition>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100"></ColumnDefinition>
                <ColumnDefinition></ColumnDefinition>
                <ColumnDefinition Width="100"></ColumnDefinition>
                <ColumnDefinition></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Border Grid.Row="0" Grid.ColumnSpan="4"  CornerRadius="3" Background="AliceBlue" BorderBrush="#C1D2E6" BorderThickness="1" Margin="0,0,0,10">
                <StackPanel>
                    <Border Margin="10,-10,0,0" BorderBrush="#6F8AA9" BorderThickness="1" Background="AliceBlue" HorizontalAlignment="Left">
                        <TextBlock Text="{Binding G1174_G1_TimKiem, Source={StaticResource eHCMSResources}}" Margin="10,0,10,0" FontWeight="Bold"></TextBlock>
                    </Border>
                    <Grid Margin="0,5,0,5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="150" />
                            <ColumnDefinition Width="270" />
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Margin="5,0,5,0"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="{Binding T2144_G1_Kho, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <AxControls:AxComboBox
                            Grid.Row="0"
                            Grid.Column="1"
                            Margin="0,2,0,2"
                            HorizontalAlignment="Stretch"
                            DisplayMemberPath="swhlName"
                            ItemsSource="{Binding AllStores}"
                            SelectedIndex="0"
                            SelectedItem="{Binding SelectedStore, Mode=TwoWay}" 
                            Style="{StaticResource MainFrame.ComboBox}"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <TextBlock Grid.Row="2" 
                            Grid.Column="0" 
                            Text="{Binding T2013_G1_Ke, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" 
                            HorizontalAlignment="Right" 
                            VerticalAlignment="Center" 
                            Margin="0,2,5,2"
                            Style="{StaticResource MainFrame.TextBlock.00}" 
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}"/>
                        <AxControls:AxComboBox Grid.Row="2" 
                            Grid.Column="1" 
                            Margin="0,2,0,2"
                            HorizontalAlignment="Stretch" 
                            ItemsSource="{Binding AllRefShelfs}" 
                            DisplayMemberPath="RefShelfName"
                            SelectedItem="{Binding SelectedRefShelf, Mode=TwoWay}" 
                            Style="{StaticResource MainFrame.ComboBox}"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <TextBlock Grid.Row="1" Grid.Column="0" 
                            Text="{Binding Z3275_G1_Day, Source={StaticResource eHCMSResources},  StringFormat='{}{0}:'}" 
                            VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,2,5,2" 
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <AxControls:AxComboBox Grid.Row="1" Grid.Column="1"
                            Margin="0,2,0,2"
                            HorizontalAlignment="Stretch" 
                            ItemsSource="{Binding AllRefRows}" 
                            DisplayMemberPath="RefRowName"
                            SelectedItem="{Binding SelectedRow, Mode=TwoWay}"
                            Style="{StaticResource MainFrame.ComboBox}"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <TextBlock Grid.Row="3" Grid.Column="0" 
                            Text="{Binding Z1997_G1_Ngan, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" 
                            HorizontalAlignment="Right" 
                            VerticalAlignment="Center" Margin="0,2,5,2"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}"/>
                        <AxControls:AxComboBox 
                            Grid.Row="3" Grid.Column="1"
                            Margin="0,2,0,2"
                            HorizontalAlignment="Stretch" ItemsSource="{Binding AllRefShelfDetails}" 
                            DisplayMemberPath="LocName"
                            SelectedItem="{Binding SelectedRefShelfDetail, Mode=TwoWay}" 
                            Style="{StaticResource MainFrame.ComboBox}"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <TextBlock Grid.Row="2" 
                            Grid.Column="3" 
                            Text="{Binding S0648_G1_SoHoSo, Source={StaticResource eHCMSResources}, StringFormat='{}{0}:'}" 
                            HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,2,5,2"
                            Style="{StaticResource MainFrame.TextBlock.00}" />
                        <TextBox MaxLength="128" 
                            Text="{Binding FileCodeNumber, Mode=TwoWay}" 
                            Grid.Row="2" 
                            Grid.Column="4" 
                            Margin="0,2,0,2"
                            Style="{StaticResource MainFrame.TextBox}" />
                        <TextBlock Grid.Row="0" 
                            Grid.Column="3" 
                            Text="{Binding T3274_G1_MaBN, Source={StaticResource eHCMSResources}, StringFormat='{}{0}:'}" 
                            HorizontalAlignment="Right" 
                            VerticalAlignment="Center" Margin="0,2,5,2"
                            Style="{StaticResource MainFrame.TextBlock.00}" />
                        <TextBox MaxLength="128"
                            Text="{Binding PatientCode, Mode=TwoWay}" 
                            Grid.Row="0" 
                            Grid.Column="4" 
                            Margin="0,2,0,2"
                            Style="{StaticResource MainFrame.TextBox}" />
                        <TextBlock Grid.Row="1" 
                            Grid.Column="3" 
                            Text="{Binding T0834_G1_TenBenhNhan, Source={StaticResource eHCMSResources}, StringFormat='{}{0}:'}" 
                            HorizontalAlignment="Right" 
                            VerticalAlignment="Center" Margin="0,2,5,2"
                            Style="{StaticResource MainFrame.TextBlock.00}" />
                        <TextBox MaxLength="128"
                            Text="{Binding PatientName, Mode=TwoWay}" 
                            Grid.Row="1" 
                            Grid.Column="4" 
                            Margin="0,2,0,2"
                            Style="{StaticResource MainFrame.TextBox}" />
                        <TextBlock Grid.Row="3" Grid.Column="3" 
                            Text="{Binding G1933_G1_TuNg, Source={StaticResource eHCMSResources}, StringFormat='{}{0}:'}" 
                            HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,2,5,2" 
                            Style="{StaticResource MainFrame.TextBlock.00}"/>
                        <Grid Grid.Row="3" Grid.Column="4" HorizontalAlignment="Left">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <DatePicker
                                Grid.Row="0"
                                Grid.Column="0"
                                Margin="0,2,5,2"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                SelectedDate="{Binding StartDate, Mode=TwoWay}"
                                Style="{StaticResource MainFrame.DatePicker}" />
                            <TextBlock Grid.Row="0" Grid.Column="1" 
                                Text="{Binding K3192_G1_DenNg, Source={StaticResource eHCMSResources}, StringFormat='{}{0}:'}" 
                                HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,2,5,2"
                                Style="{StaticResource MainFrame.TextBlock.00}"/>
                            <DatePicker
                                Grid.Row="0"
                                Grid.Column="2"
                                Margin="0,2,0,2"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                SelectedDate="{Binding EndDate, Mode=TwoWay}"
                                Style="{StaticResource MainFrame.DatePicker}" />
                        </Grid>
                        <StackPanel
                            Grid.Row="3"
                            Grid.Column="5"
                            Margin="10,2,5,2"
                            HorizontalAlignment="Stretch"
                            Orientation="Horizontal">
                            <Button
                                x:Name="btnSearchMedicalFileCheckOut"
                                Width="80"
                                HorizontalAlignment="Right"
                                Content="{Binding G0981_G1_Tim, Source={StaticResource eHCMSResources}}"
                                Style="{StaticResource MainFrame.Button}" />
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>
            <Border Grid.Row="1" Grid.ColumnSpan="4" CornerRadius="3" Background="AliceBlue" BorderBrush="#C1D2E6" BorderThickness="1" Margin="0,10,0,10">
                <StackPanel>
                    <Border Margin="10,-10,0,0" BorderBrush="#6F8AA9" BorderThickness="1" Background="AliceBlue" HorizontalAlignment="Left">
                        <TextBlock Text="{Binding Z3265_G1_DSHoSo, Source={StaticResource eHCMSResources}}" Margin="10,0,10,0" FontWeight="Bold" />
                    </Border>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"></RowDefinition>
                            <RowDefinition Height="Auto"></RowDefinition>
                        </Grid.RowDefinitions>
                    </Grid>
                    <AxControls:AxDataGridNy
                        Grid.Row="0"
                        Height="500"
                        AutoGenerateColumns="False" 
                        x:Name="gvMedicalFileCheckOut" 
                        CanUserAddRows="False"
                        Margin="5"
                        HorizontalAlignment="Stretch" 
                        VerticalAlignment="Top"
                        HeadersVisibility="All"
                        ItemsSource="{Binding AllPatientMedicalFileStorageCheckOut, Mode=OneWay}"
                        SelectedItem="{Binding SelectedFileStorage, Mode=TwoWay}"
                        HorizontalScrollBarVisibility="Auto"  
                        VerticalScrollBarVisibility="Auto"                        
                        ColumnHeaderStyle="{StaticResource MainFrame.DataGridColumnHeaderStyle}"
                        cal:Message.Attach="[Event Loaded]=[Action gvMedicalFileCheckOut_Loaded($source,$eventArgs)];      [Event LoadingRow] = [Action grd_LoadingRow($source, $eventArgs)]"
                        Style="{StaticResource MainFrame.DataGridStyle}"
                        RowStyle="{StaticResource MainFrame.DataGridRowStyle.Normal}"
                        Opacity="5" >
                        <DataGrid.Resources>
                            <AxControls:BindingProxy x:Key="proxy" Data="{Binding}" />
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <DataGridTemplateColumn>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                            <CheckBox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" 
                                                IsEnabled="{Binding FileStorageStatus, Converter={StaticResource EnumFileStorageStatusToBoolean}}"
                                                Visibility="{Binding Data.IsCheckIn, Source={StaticResource proxy}, Converter={StaticResource BooleanToVisibilityNot}}" />
                                            <CheckBox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" 
                                                Visibility="{Binding Data.IsCheckIn, Source={StaticResource proxy}, Converter={StaticResource BooleanToVisibility}}" />
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="{Binding S0648_G1_SoHoSo, Source={StaticResource eHCMSResources}}" 
                                IsReadOnly="True" Binding="{Binding FileCodeNumber}" 
                                CanUserReorder="True" CanUserResize="True" 
                                CanUserSort="True"  MinWidth="100" 
                                ElementStyle="{StaticResource MainFrame.TextBlockLeftAlign}" />
                            <DataGridTextColumn
                                MinWidth="100"
                                Binding="{Binding PatientCode}"
                                CanUserReorder="True"
                                CanUserResize="True"
                                CanUserSort="True"
                                ElementStyle="{StaticResource MainFrame.TextBlockCenterAlign}"
                                Header="{Binding T3274_G1_MaBN, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />
                            <DataGridTextColumn
                                MinWidth="120"
                                Binding="{Binding FullName}"
                                CanUserReorder="True"
                                CanUserResize="True"
                                CanUserSort="True"
                                ElementStyle="{StaticResource MainFrame.TextBlockLeftAlign}"
                                Header="{Binding T1580_G1_HoTenBN, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />
                            <DataGridTextColumn
                                MinWidth="100"
                                Binding="{Binding yDOB, StringFormat=dd/MM/yyyy}"
                                CanUserReorder="True"
                                CanUserResize="True"
                                CanUserSort="True"
                                ElementStyle="{StaticResource MainFrame.TextBlockCenterAlign}"
                                Header="{Binding N0036_G1_NSinh, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />
                            <DataGridTextColumn
                                MinWidth="100"
                                Binding="{Binding FileCreatedDate, StringFormat=dd/MM/yyyy}"
                                CanUserReorder="True"
                                CanUserResize="True"
                                CanUserSort="True"
                                ElementStyle="{StaticResource MainFrame.TextBlockCenterAlign}"
                                Header="Ngày bắt đầu"
                                IsReadOnly="True" />
                            <DataGridTextColumn
                                MinWidth="100"
                                Binding="{Binding FileEndDate, StringFormat=dd/MM/yyyy}"
                                CanUserReorder="True"
                                CanUserResize="True"
                                CanUserSort="True"
                                ElementStyle="{StaticResource MainFrame.TextBlockCenterAlign}"
                                Header="Ngày kết thúc"
                                IsReadOnly="True" />
                            <DataGridTextColumn
                                Visibility="{Binding Data.IsCheckIn, Source={StaticResource proxy}, Converter={StaticResource BooleanToVisibility}}"
                                MinWidth="100"
                                Binding="{Binding CheckoutDate, StringFormat=dd/MM/yyyy}"
                                CanUserReorder="True"
                                CanUserResize="True"
                                CanUserSort="True"
                                ElementStyle="{StaticResource MainFrame.TextBlockCenterAlign}"
                                Header="{Binding Z2041_G1_NgayMuon, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />
                            <DataGridTextColumn
                                Visibility="{Binding Data.IsCheckIn, Source={StaticResource proxy}, Converter={StaticResource BooleanToVisibility}}"
                                MinWidth="100"
                                Binding="{Binding CheckinDate, StringFormat=dd/MM/yyyy}"
                                CanUserReorder="True"
                                CanUserResize="True"
                                CanUserSort="True"
                                ElementStyle="{StaticResource MainFrame.TextBlockCenterAlign}"
                                Header="Ngày đến hạn trả"
                                IsReadOnly="True" />
                            <DataGridTextColumn 
                                Header="{Binding G1319_G1_TTrang, Source={StaticResource eHCMSResources}}" 
                                IsReadOnly="True" Binding="{Binding Status}" 
                                CanUserReorder="True" 
                                CanUserResize="True" CanUserSort="True"  
                                MinWidth="150" ElementStyle="{StaticResource MainFrame.TextBlockLeftAlign}" 
                                Visibility="{Binding Data.IsCheckIn, Source={StaticResource proxy}, Converter={StaticResource BooleanToVisibilityNot}}" />
                        </DataGrid.Columns>
                    </AxControls:AxDataGridNy>
                    <AxControls:DataPager
                        Grid.Row="1"
                        Margin="3,0,0,5"
                        PageSize="{Binding PageSize, Mode=OneTime}"
                        Source="{Binding AllPatientMedicalFileStorageCheckOut, Mode=TwoWay}" />
                </StackPanel>
            </Border>
            <Border Grid.Row="2" Grid.ColumnSpan="4" CornerRadius="3" Background="AliceBlue" BorderBrush="#C1D2E6" BorderThickness="1" Margin="0,10,0,10">
                <StackPanel>
                    <Border Margin="10,-10,0,0" BorderBrush="#6F8AA9" BorderThickness="1" Background="AliceBlue" HorizontalAlignment="Left">
                        <TextBlock Text="{Binding SubTitleForm}" Margin="10,0,10,0" FontWeight="Bold"></TextBlock>
                    </Border>
                    <Grid Margin="0,5,0,5">
                        <Grid.RowDefinitions>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="150"></ColumnDefinition>
                            <ColumnDefinition Width="250"></ColumnDefinition>
                            <ColumnDefinition Width="150"></ColumnDefinition>
                            <ColumnDefinition Width="250"></ColumnDefinition>
                            <ColumnDefinition Width="150"></ColumnDefinition>
                            <ColumnDefinition Width="250"></ColumnDefinition>
                            <ColumnDefinition Width="100"></ColumnDefinition>
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="2"
                            Margin="0,2,5,2"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="Người cho mượn:"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <AxControls:AxAutoComplete
                            Name="cboBorrowBy" 
                            Grid.Row="1" Grid.Column="3" 
                            IsDropDownOpen="True" MinimumPopulateDelay="300"
                            Width="200"
                            Margin="0,2,0,2"
                            HorizontalAlignment="Left"
                            ValueMemberBinding="{Binding FullName, Mode=TwoWay}"
                            cal:Message.Attach="[Event Loaded] = [Action cboBorrowBy_Loaded($source, $eventArgs)]
                            ;[Event Populating] = [Action cboBorrowBy_Populating($source, $eventArgs)]
                            ;[Event DropDownClosed] = [Action cboBorrowBy_DropDownClosed($source, $eventArgs)]"   
                            Style="{StaticResource AxAutoCompleteMyStyle}" 
                            MinimumPrefixLength="0" FilterMode="None">
                            <AutoBoxTK:AutoCompleteBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel>
                                        <TextBlock MinWidth="150" Text="{Binding FullName}" Style="{StaticResource MainFrame.TextBlock.01}" Margin="0" Padding="0" />
                                    </StackPanel>
                                </DataTemplate>
                            </AutoBoxTK:AutoCompleteBox.ItemTemplate>
                        </AxControls:AxAutoComplete>
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="2"
                            Margin="0,2,5,2"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="{Binding N0160_G1_NguoiNhan, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibility}}" />
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Margin="0,2,5,2"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="{Binding Z1965_G1_KhoaMuon, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" 
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Margin="0,2,5,2"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="Khoa trả:" 
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibility}}"/>
                        <AxControls:AxComboBox Grid.Row="0" 
                            Grid.Column="1" Width="200" 
                            HorizontalAlignment="Left" Margin="0,2,0,2"
                            SelectedItemEx="{Binding SelectedDepartment, Mode=TwoWay}" 
                            DisplayMemberPath="DeptName" 
                            SelectedValuePath="DeptID"
                            ItemsSource="{Binding Departments,Mode=OneWay}" 
                            Style="{StaticResource MainFrame.ComboBox}"/>
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="0,2,5,2"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="{Binding Z1966_G1_PhongMuon, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="0,2,5,2"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="Phòng trả:"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibility}}" />
                        <AxControls:AxComboBox x:Name="Locations" 
                            Margin="0,2,0,2" 
                            Style="{StaticResource MainFrame.ComboBox}"
                            ItemsSource="{Binding Locations, Mode=OneWay}"
                            SelectedValuePath="DeptLocationID" HorizontalAlignment="Left"
                            SelectedItemEx="{Binding SelectedLocation,Mode=TwoWay}" 
                            Grid.Column="1" Grid.Row="1" 
                            DisplayMemberPath="Location.LocationName" Width="200" />
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="2"
                            Margin="0,2,5,2"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="{Binding Z1964_G1_NgMuon, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" 
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <AxControls:AxAutoComplete
                            Name="cboBorrow"
                            Grid.Row="0" Grid.Column="3" 
                            IsDropDownOpen="True" MinimumPopulateDelay="300"
                            Width="200"
                            Margin="0,2,0,2"
                            HorizontalAlignment="Left"
                            ValueMemberBinding="{Binding FullName, Mode=TwoWay}"
                            cal:Message.Attach="[Event Loaded] = [Action cboBorrow_Loaded($source, $eventArgs)]
                            ;[Event Populating] = [Action cboBorrow_Populating($source, $eventArgs)]
                            ;[Event DropDownClosed] = [Action cboBorrow_DropDownClosed($source, $eventArgs)]"   
                            Style="{StaticResource AxAutoCompleteMyStyle}" 
                            MinimumPrefixLength="0" FilterMode="None">
                            <AutoBoxTK:AutoCompleteBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel>
                                        <TextBlock MinWidth="150" Text="{Binding FullName}" Style="{StaticResource MainFrame.TextBlock.01}" Margin="0" Padding="0" />
                                    </StackPanel>
                                </DataTemplate>
                            </AutoBoxTK:AutoCompleteBox.ItemTemplate>
                        </AxControls:AxAutoComplete>
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="2"
                            Margin="0,2,5,2"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="Người trả:" 
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibility}}" />
                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="2"
                            Margin="0,2,5,2"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="Số ngày hoàn trả:"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <AxControls:AxTextBoxFilter
                            Grid.Row="2" 
                            Grid.Column="3" 
                            Margin="0,2,0,2" Width="200" 
                            HorizontalAlignment="Left" 
                            IsTabStop="True"
                            Text="{Binding BorrowingDay, Mode=TwoWay}" 
                            Filter="{Binding IntNumberFilter, Mode=OneWay}"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" 
                            Style="{StaticResource MainFrame.TextBox}" />
                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="0"
                            Margin="0,2,5,2"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="Lý do mượn:" 
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <AxControls:AxComboBox 
                            Grid.Row="2" 
                            Grid.Column="1"
                            Margin="0,2,0,2"
                            HorizontalAlignment="Left" ItemsSource="{Binding V_ReasonType}" 
                            DisplayMemberPath="ObjectValue"
                            SelectedValuePath="LookupID"
                            SelectedItem="{Binding SelectedReasonType, Mode=TwoWay}" 
                            Style="{StaticResource MainFrame.ComboBox}"
                            Width="200" 
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="4"
                            Margin="0,2,5,2"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="{Binding G1183_G1_Ghichu, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" 
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <TextBox
                            Grid.Row="0" 
                            Grid.Column="5" 
                            Margin="0,2,0,2"
                            HorizontalAlignment="Stretch" 
                            IsTabStop="True"
                            Text="{Binding Notes, Mode=TwoWay}"
                            Grid.ColumnSpan="2"
                            Grid.RowSpan="3"
                            AcceptsReturn="True"
                            Style="{StaticResource MainFrame.TextBox}"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibilityNot}}" />
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="4"
                            Margin="0,2,5,2"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="{Binding N0124_G1_NgTra, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" 
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibility}}" />
                        <DatePicker
                            Grid.Row="0"
                            Grid.Column="5"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            SelectedDate="{Binding CheckinDate, Mode=TwoWay}"
                            Style="{StaticResource MainFrame.DatePicker}" 
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibility}}"/>
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="4"
                            Margin="0,2,5,2"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Style="{StaticResource MainFrame.TextBlock.00}"
                            Text="Tình trạng hồ sơ:" 
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibility}}" />
                        <TextBox
                            Grid.Row="1" 
                            Grid.Column="5" 
                            Margin="0,2,0,2"
                            HorizontalAlignment="Stretch" 
                            IsTabStop="True"
                            Text="{Binding CheckinStatus, Mode=TwoWay}"
                            Grid.ColumnSpan="2"
                            Style="{StaticResource MainFrame.TextBox}"
                            Visibility="{Binding IsCheckIn,Converter={StaticResource BooleanToVisibility}}" />
                    </Grid>
                </StackPanel>
            </Border>
            <StackPanel Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="4" Orientation="Horizontal" HorizontalAlignment="Center">
                <Button x:Name="btnUpdate" Width="80" Content="{Binding ContentButtonUpdate}" HorizontalAlignment="Left" Margin="0,0,0,10" Style="{StaticResource MainFrame.Button}" />
                <Button x:Name="btnRefresh" Width="80" Content="{Binding T2535_G1_LamMoi, Source={StaticResource eHCMSResources}}" HorizontalAlignment="Left" Margin="10,0,0,10" Style="{StaticResource MainFrame.Button}" />
            </StackPanel>
        </Grid>
    </Grid>
    <!--</toolkit:BusyIndicator>-->
</UserControl>

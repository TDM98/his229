<UserControl
    x:Class="aEMR.Pharmacy.Views.EditOutwardInternalView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:AxControls="clr-namespace:aEMR.Controls;assembly=aEMR.Controls"
    xmlns:Resources="clr-namespace:eHCMSLanguage;assembly=aEMRLanguage"
    xmlns:cal="http://www.caliburnproject.org"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:toolkit="http://schemas.xceed.com/wpf/xaml/toolkit"
    d:DesignHeight="300"
    d:DesignWidth="800"
    mc:Ignorable="d">
    <UserControl.Resources>
        <Resources:eHCMSResources x:Key="eHCMSResources" />
        <BooleanToVisibilityConverter x:Key="BooleanToVisibility" />
        <DataTemplate x:Key="ColDeleteTemplate">
            <Button
                x:Name="lnkDelete"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                cal:Message.Attach="[Event Click] = [Action lnkDelete_Click($source, $eventArgs)]"
                ToolTipService.ToolTip="{Binding G2617_G1_Xoa, Source={StaticResource eHCMSResources}}">
                <Image
                    Width="13"
                    Height="13"
                    Opacity="1"
                    Source="/aEMR.CommonViews;component/Assets/Images/Delete.png" />
            </Button>
        </DataTemplate>
        <DataTemplate x:Key="ColChooseLoTemplate">
            <Button
                x:Name="lnkChooseBatchNumber"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                cal:Message.Attach="[Event Click] = [Action lnkChooseBatchNumber_Click($source, $eventArgs)]"
                CommandParameter="{Binding GetDrugForSellVisitor.DrugID}"
                Content="{Binding InBatchNumber, Mode=TwoWay}"
                Style="{StaticResource MainFrame.HyperlinkButton.01}"
                ToolTipService.ToolTip="{Binding Z0056_G1_ChonLoKhac, Source={StaticResource eHCMSResources}}" />
        </DataTemplate>
        <DataTemplate x:Key="AutoCompleteTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock
                    Name="txtDrugName"
                    Style="{StaticResource MainFrame.TextBlock.Auto}"
                    Text="{Binding BrandName}" />
                <TextBlock Style="{StaticResource MainFrame.TextBlock.Auto}" Text=" - " />
                <TextBlock Style="{StaticResource MainFrame.TextBlock.Auto}" Text="{Binding Remaining}" />
                <TextBlock
                    Margin="10,0,0,0"
                    Style="{StaticResource MainFrame.TextBlock.Auto}"
                    Text="{Binding UnitName}" />
            </StackPanel>
        </DataTemplate>
    </UserControl.Resources>
    <toolkit:BusyIndicator
        Margin="0,0,0,10"
        HorizontalAlignment="Stretch"
        VerticalAlignment="Stretch"
        DisplayAfter="0:0:0.100"
        IsBusy="{Binding IsLoading, Mode=OneWay}">
        <AxControls:AxGrid x:Name="LayoutRoot">
            <Grid.RowDefinitions>
                <RowDefinition Height="30" />
                <RowDefinition Height="25" />
                <RowDefinition Height="Auto" />
                <RowDefinition />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <TextBlock
                x:Name="TitleForm"
                Grid.ColumnSpan="2"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                FontSize="14"
                FontWeight="Bold"
                Foreground="#3595CB"
                Text="{Binding TitleForm}" />
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="180" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <StackPanel
                    Grid.Column="3"
                    Margin="0,1"
                    HorizontalAlignment="Right"
                    Orientation="Horizontal">
                    <TextBlock
                        Margin="20,1,1,1"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Style="{StaticResource MainFrame.TextBlock.00}"
                        Text="{Binding T2144_G1_Kho, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}" />
                    <AxControls:KeyEnabledComboBox
                        Name="comboBox1"
                        MinWidth="120"
                        MaxWidth="200"
                        Margin="1,1,10,1"
                        DisplayMemberPath="swhlName"
                        IsEnabled="False"
                        IsTabStop="True"
                        ItemsSource="{Binding StoreCbx}"
                        SelectedValueEx="{Binding StoreID, Mode=TwoWay}"
                        SelectedValuePath="StoreID"
                        Style="{StaticResource MainFrame.ComboBox}" />
                    <TextBlock
                        Margin="1"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Style="{StaticResource MainFrame.TextBlock.00}"
                        Text="{Binding N0194_G1_NhVien, StringFormat='{}{0} :', Source={StaticResource eHCMSResources}}" />
                    <TextBlock
                        Grid.Row="1"
                        Grid.Column="2"
                        Margin="1,1,10,1"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Style="{StaticResource MainFrame.TextBlock.00}"
                        Text="{Binding StaffName}"
                        TextWrapping="NoWrap" />
                </StackPanel>

            </Grid>

            <Grid Grid.Row="2" DataContext="{Binding SelectedOutInvoice, Mode=TwoWay}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="350*" />
                    <ColumnDefinition Width="600*" />
                </Grid.ColumnDefinitions>
                <Border
                    Grid.Row="1"
                    Grid.ColumnSpan="2"
                    Margin="2"
                    Style="{StaticResource LightBlueBorderStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="25" />
                            <RowDefinition Height="25" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="120" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="150" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.Row="1"
                            Margin="5,1,5,1"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Style="{StaticResource MainFrame.TextBlock.02}"
                            Text="{Binding T3534_G1_MaPhX, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}"
                            TextWrapping="Wrap" />

                        <TextBox
                            Grid.Row="1"
                            Grid.Column="1"
                            Margin="1,1,1,0"
                            VerticalAlignment="Top"
                            IsReadOnly="True"
                            Style="{StaticResource MainFrame.TextBox}"
                            Text="{Binding OutInvID}"
                            d:LayoutOverrides="Width" />

                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="0"
                            Margin="5,1,5,1"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Style="{StaticResource MainFrame.TextBlock.02}"
                            Text="{Binding N0130_G1_NgXuat, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}"
                            TextWrapping="Wrap" />
                        <DatePicker
                            Grid.Row="2"
                            Grid.Column="1"
                            Margin="1"
                            IsEnabled="False"
                            SelectedDate="{Binding OutDate, TargetNullValue=null, Mode=TwoWay}"
                            Style="{StaticResource MainFrame.DatePicker}" />
                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="2"
                            Margin="5,1,5,1"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Style="{StaticResource MainFrame.TextBlock.02}"
                            Text="{Binding N0297_G1_NhVienXuat, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}"
                            TextWrapping="Wrap" />
                        <TextBox
                            Grid.Row="2"
                            Grid.Column="3"
                            Margin="1"
                            IsReadOnly="True"
                            Style="{StaticResource MainFrame.TextBox}"
                            Text="{Binding SelectedStaff.IDAndFullName, Mode=TwoWay}"
                            d:LayoutOverrides="Width" />
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="2"
                            Margin="5,1,5,1"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Style="{StaticResource MainFrame.TextBlock.02}"
                            Text="{Binding T3571_G1_MaPhYC, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}"
                            TextWrapping="Wrap" />

                        <TextBox
                            Grid.Row="1"
                            Grid.Column="3"
                            Margin="1"
                            IsReadOnly="True"
                            Style="{StaticResource MainFrame.TextBox}"
                            Text="{Binding ReqNumCode}"
                            d:LayoutOverrides="Width" />
                        <Button
                            Name="btnFindRequest"
                            Grid.Row="1"
                            Grid.Column="4"
                            Width="20"
                            Content="..."
                            IsEnabled="False"
                            Style="{StaticResource MainFrame.Button}"
                            Visibility="{Binding bBtnEdit, Converter={StaticResource BooleanToVisibility}}" />
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="5"
                            Margin="5,1,5,1"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Style="{StaticResource MainFrame.TextBlock.02}"
                            Text="{Binding T2189_G1_KhoNhan, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}"
                            TextWrapping="Wrap"
                            Visibility="{Binding ElementName=LayoutRoot, Path=DataContext.IsInternalForStore, Converter={StaticResource VisibilityConverter}}" />
                        <AxControls:KeyEnabledComboBox
                            Name="cbxInDeptStorage"
                            Grid.Row="1"
                            Grid.Column="6"
                            Margin="1"
                            cal:Message.Attach="[Event SelectionChanged] = [Action SelectedByToStore_SelectionChanged($source, $eventArgs)]"
                            DisplayMemberPath="swhlName"
                            IsEnabled="False"
                            ItemsSource="{Binding ElementName=LayoutRoot, Path=DataContext.FromStoreCbx}"
                            SelectedValueEx="{Binding ToStoreID, Mode=TwoWay}"
                            SelectedValuePath="StoreID"
                            Style="{StaticResource MainFrame.ComboBox}"
                            Visibility="{Binding ElementName=LayoutRoot, Path=DataContext.IsInternalForStore, Converter={StaticResource VisibilityConverter}}" />

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="5"
                            Margin="5,1,5,1"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Style="{StaticResource MainFrame.TextBlock.02}"
                            Text="{Binding K0962_G1_BSiNhan, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}"
                            TextWrapping="Wrap"
                            Visibility="{Binding ElementName=LayoutRoot, Path=DataContext.IsInternalForDoctor, Converter={StaticResource VisibilityConverter}}" />
                        <AxControls:KeyEnabledComboBox
                            Name="cbxNguoiNhan"
                            Grid.Row="1"
                            Grid.Column="6"
                            Margin="1"
                            cal:Message.Attach="[Event SelectionChanged] = [Action SelectedByToStaff_SelectionChanged($source, $eventArgs)]"
                            DisplayMemberPath="TypeAndFullName"
                            IsEnabled="False"
                            ItemsSource="{Binding ElementName=LayoutRoot, Path=DataContext.ListStaff}"
                            SelectedValueEx="{Binding ToStaffID, Mode=TwoWay}"
                            SelectedValuePath="StaffID"
                            Style="{StaticResource MainFrame.ComboBox}"
                            Visibility="{Binding ElementName=LayoutRoot, Path=DataContext.IsInternalForDoctor, Converter={StaticResource VisibilityConverter}}" />

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="5"
                            Margin="5,1,5,1"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Style="{StaticResource MainFrame.TextBlock.02}"
                            Text="{Binding K1400_G1_BVBan, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}"
                            TextWrapping="Wrap"
                            Visibility="{Binding ElementName=LayoutRoot, Path=DataContext.IsInternalForHospital, Converter={StaticResource VisibilityConverter}}" />
                        <AxControls:KeyEnabledComboBox
                            Name="cbxBVBan"
                            Grid.Row="1"
                            Grid.Column="6"
                            Margin="1"
                            cal:Message.Attach="[Event SelectionChanged] = [Action SelectedByToHospital_SelectionChanged($source, $eventArgs)]"
                            DisplayMemberPath="HosName"
                            IsEnabled="False"
                            ItemsSource="{Binding ElementName=LayoutRoot, Path=DataContext.Hospitals}"
                            SelectedValueEx="{Binding HosID, Mode=TwoWay}"
                            SelectedValuePath="HosID"
                            Style="{StaticResource MainFrame.ComboBox}"
                            Visibility="{Binding ElementName=LayoutRoot, Path=DataContext.IsInternalForHospital, Converter={StaticResource VisibilityConverter}}" />

                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="5"
                            Margin="0,-1,2,3"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Style="{StaticResource MainFrame.TextBlock.02}"
                            Text="{Binding G1183_G1_Ghichu, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}"
                            TextWrapping="Wrap" />
                        <TextBox
                            Grid.Row="2"
                            Grid.Column="6"
                            Margin="1"
                            Style="{StaticResource MainFrame.TextBox}"
                            Text="{Binding Notes, Mode=TwoWay}"
                            d:LayoutOverrides="Width" />

                        <TextBlock
                            x:Name="tbloutiID"
                            Height="21"
                            Text="{Binding outiID}"
                            Visibility="Collapsed" />
                        <StackPanel
                            Grid.Column="0"
                            Grid.ColumnSpan="4"
                            HorizontalAlignment="Left"
                            Orientation="Horizontal">
                            <TextBlock
                                Margin="2,1"
                                VerticalAlignment="Center"
                                Style="{StaticResource MainFrame.TextBlock.00}"
                                Text="{Binding T2873_G1_LoaiXuat, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}" />
                            <AxControls:KeyEnabledComboBox
                                Grid.Row="1"
                                Grid.Column="6"
                                MinWidth="140"
                                Margin="1"
                                cal:Message.Attach="[Event SelectionChanged] = [Action SelectedOutputType_SelectionChanged($source, $eventArgs)]"
                                DisplayMemberPath="TypNamePharmacy"
                                IsEnabled="{Binding CanSaveAndPaid}"
                                ItemsSource="{Binding ElementName=LayoutRoot, Path=DataContext.RefOutputTypeList}"
                                SelectedValueEx="{Binding TypID, Mode=TwoWay}"
                                SelectedValuePath="TypID"
                                Style="{StaticResource MainFrame.ComboBox}" />

                            <TextBlock
                                Margin="10,1,2,1"
                                VerticalAlignment="Center"
                                Style="{StaticResource MainFrame.TextBlock.00}"
                                Text="{Binding K1008_G1_BanTheo, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}" />
                            <AxControls:KeyEnabledComboBox
                                Grid.Row="1"
                                Grid.Column="6"
                                MinWidth="120"
                                Margin="1"
                                cal:Message.Attach="[Event SelectionChanged] = [Action SelectedByOutPrice_SelectionChanged($source, $eventArgs)]"
                                DisplayMemberPath="ObjectValue"
                                IsEnabled="{Binding ElementName=LayoutRoot, Path=DataContext.CanSelectByOutPrice}"
                                ItemsSource="{Binding ElementName=LayoutRoot, Path=DataContext.ByOutPriceLookups}"
                                SelectedValueEx="{Binding V_ByOutPrice, Mode=TwoWay}"
                                SelectedValuePath="LookupID"
                                Style="{StaticResource MainFrame.ComboBox}" />

                            <!--<RadioButton GroupName="Price" Content="{Binding T1160_G1_GVon, Source={StaticResource eHCMSResources}}" Margin="2,1" VerticalAlignment="Center" Style="{StaticResource MainFrame.RadioButton}"   cal:Message.Attach="[Event Checked] = [Action RadioButtonCost_Checked($source, $eventArgs)]" ></RadioButton>
                            <RadioButton GroupName="Price" Content="{Binding T1147_G1_GiaThongThuong, Source={StaticResource eHCMSResources}}" Margin="2,1" VerticalAlignment="Center" Style="{StaticResource MainFrame.RadioButton}"  cal:Message.Attach="[Event Checked] = [Action RadioButtonNormal_Checked($source, $eventArgs)]" ></RadioButton>
                            <RadioButton GroupName="Price" Content="{Binding T1100_G1_GiaKhac, Source={StaticResource eHCMSResources}}" Margin="2,1" VerticalAlignment="Center" Style="{StaticResource MainFrame.RadioButton}"  cal:Message.Attach="[Event Checked] = [Action RadioButtonOther_Checked($source, $eventArgs)]" ></RadioButton>-->
                        </StackPanel>
                        <StackPanel
                            Grid.Column="4"
                            Grid.ColumnSpan="8"
                            HorizontalAlignment="Right"
                            Orientation="Horizontal">
                            <TextBlock
                                Margin="2,1"
                                VerticalAlignment="Center"
                                Style="{StaticResource MainFrame.TextBlock.00}"
                                Text="{Binding G2844_G1_XuatDen, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}" />
                            <RadioButton
                                Margin="2,1"
                                VerticalAlignment="Center"
                                Content="{Binding T2144_G1_Kho, Source={StaticResource eHCMSResources}}"
                                IsChecked="{Binding ElementName=LayoutRoot, Path=DataContext.IsInternalForStore, Mode=TwoWay}"
                                IsEnabled="{Binding ElementName=LayoutRoot, Path=DataContext.IsEnableToStore}" />
                            <RadioButton
                                Margin="2,1"
                                VerticalAlignment="Center"
                                Content="{Binding K0961_G1_BSi, Source={StaticResource eHCMSResources}}"
                                IsChecked="{Binding ElementName=LayoutRoot, Path=DataContext.IsInternalForDoctor, Mode=TwoWay}"
                                IsEnabled="{Binding ElementName=LayoutRoot, Path=DataContext.IsEnableToStore}" />
                            <RadioButton
                                Margin="2,1"
                                VerticalAlignment="Center"
                                Content="{Binding K1400_G1_BVBan, Source={StaticResource eHCMSResources}}"
                                IsChecked="{Binding ElementName=LayoutRoot, Path=DataContext.IsInternalForHospital, Mode=TwoWay}"
                                IsEnabled="{Binding ElementName=LayoutRoot, Path=DataContext.IsEnableToStore}" />
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>

            <Border
                Grid.Row="3"
                Margin="3"
                Style="{StaticResource LightBlueBorderStyle}">
                <Grid x:Name="Details">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="200*" />
                        <RowDefinition Height="22" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="80" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Border
                        Grid.Row="0"
                        Grid.Column="0"
                        Grid.ColumnSpan="3"
                        Margin="2"
                        Style="{StaticResource LightBlueBorderStyle}">
                        <Grid Name="grid1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="80*" MaxWidth="100" />
                                <ColumnDefinition Width="240*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="60*" MaxWidth="120" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="80*" MaxWidth="120" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="60*" MaxWidth="120" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <CheckBox
                                Grid.Column="0"
                                Grid.ColumnSpan="4"
                                Margin="3,2,5,2"
                                VerticalAlignment="Center"
                                VerticalContentAlignment="Center"
                                cal:Message.Attach="[Event Loaded]=[Action chkSearchByGenericName_Loaded($source,$eventArgs)]"
                                Content="{Binding G1265_G1_TimThuocTheoTenChung, Source={StaticResource eHCMSResources}}"
                                IsChecked="{Binding IsDlgSearchByGenericName, Mode=TwoWay}"
                                IsThreeState="False"
                                Style="{StaticResource MainFrame.Checkbox}"
                                Visibility="{Binding vIsSearchByGenericName, Converter={StaticResource BooleanToVisibility}}" />
                            <StackPanel Grid.Row="1" Orientation="Horizontal">
                                <TextBlock
                                    Margin="2,1"
                                    VerticalAlignment="Center"
                                    Style="{StaticResource MainFrame.TextBlock.02}"
                                    Text="{Binding K2170_G1_ChonThuoc, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" />
                                <RadioButton
                                    Margin="2,1"
                                    VerticalAlignment="Center"
                                    cal:Message.Attach="[Event Checked]=[Action Code_Checked($source,$eventArgs)]"
                                    Content="{Binding K2569_G1_Code, Source={StaticResource eHCMSResources}}"
                                    GroupName="ChooseDrug" />
                                <RadioButton
                                    Margin="2,1"
                                    VerticalAlignment="Center"
                                    cal:Message.Attach="[Event Checked]=[Action Name_Checked($source,$eventArgs)]"
                                    Content="{Binding T0829_G1_Ten, Source={StaticResource eHCMSResources}}"
                                    GroupName="ChooseDrug"
                                    IsChecked="True" />
                            </StackPanel>

                            <!--<TextBlock Margin="2,1"  HorizontalAlignment="Right" VerticalAlignment="Center" Text="{Binding K2170_G1_ChonThuoc, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.01}" />-->
                            <AxControls:AxTextBox
                                Grid.Row="1"
                                Grid.Column="1"
                                Margin="2,1"
                                cal:Message.Attach="[Event LostFocus] = [Action AxTextBox_LostFocus($source, $eventArgs)];                                 [Event Loaded] = [Action AxTextBox_Loaded($source, $eventArgs)]"
                                IsEnabled="{Binding VisibilityCode, Mode=OneWay}"
                                Style="{StaticResource MainFrame.TextBox}"
                                Text="{Binding SelectedSellVisitor.DrugCode, Mode=TwoWay}" />
                            <AxControls:AxAutoComplete
                                Name="AutoDrug_Text"
                                Grid.Row="1"
                                Grid.Column="2"
                                Margin="2,1"
                                cal:Message.Attach="[Event Populating] = [Action AutoCompleteBox_Populating($source, $eventArgs)];                                 [Event DropDownClosed] = [Action AutoDrug_Text_DropDownClosed($source, $eventArgs)];                                 [Event Loaded] = [Action AutoDrug_Text_Loaded($source, $eventArgs)]"
                                FilterMode="None"
                                FontWeight="Bold"
                                IsEnabled="{Binding VisibilityName, Mode=OneWay}"
                                IsTabStop="False"
                                ItemTemplate="{StaticResource AutoCompleteTemplate}"
                                ItemsSource="{Binding GetDrugForSellVisitorListSum, Mode=OneWay}"
                                SelectedItem="{Binding SelectedSellVisitor, Mode=TwoWay}"
                                Style="{StaticResource AxAutoCompleteMyStyle}"
                                Text="{Binding SelectedSellVisitor.BrandName}"
                                TextBoxStyle="{StaticResource MainFrame.TextBox}"
                                ValueMemberBinding="{Binding BrandName, Mode=TwoWay}" />

                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="3"
                                Margin="2,1"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                Style="{StaticResource MainFrame.TextBlock.01}"
                                Text="{Binding K3966_G1_Dvt, Source={StaticResource eHCMSResources}}" />
                            <TextBox
                                Grid.Row="1"
                                Grid.Column="4"
                                Margin="2,1"
                                IsEnabled="False"
                                Style="{StaticResource MainFrame.TextBox}"
                                Text="{Binding SelectedSellVisitor.UnitName, Mode=OneWay}" />
                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="5"
                                Margin="2,1"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                Style="{StaticResource MainFrame.TextBlock.01}"
                                Text="{Binding S0610_G1_SLgTon, Source={StaticResource eHCMSResources}}" />
                            <AxControls:AxTextBox
                                Grid.Row="1"
                                Grid.Column="6"
                                Margin="2,1"
                                IsEnabled="False"
                                Style="{StaticResource MainFrame.TextBox}"
                                Text="{Binding SelectedSellVisitor.Remaining, Converter={StaticResource DecimalConverter}}"
                                TextAlignment="Right" />
                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="7"
                                Margin="2,1"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                Style="{StaticResource MainFrame.TextBlock.01}"
                                Text="{Binding S0612_G1_SLgXuat, Source={StaticResource eHCMSResources}}" />
                            <AxControls:AxTextBox
                                Grid.Row="1"
                                Grid.Column="8"
                                Margin="2,1"
                                cal:Message.Attach="[Event Loaded] = [Action Quantity_Loaded($source, $eventArgs)]"
                                Style="{StaticResource MainFrame.TextBox}"
                                Text="{Binding SelectedSellVisitor.RequiredNumber, Mode=TwoWay}"
                                TextAlignment="Right" />

                            <Button
                                Name="AddItem"
                                Grid.Row="1"
                                Grid.Column="9"
                                Width="75"
                                Height="Auto"
                                Margin="2,1"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Content="{Binding G0156_G1_Them, Source={StaticResource eHCMSResources}}"
                                Style="{StaticResource MainFrame.Button}" />
                        </Grid>
                    </Border>
                    <DataGrid
                        x:Name="grdPrescription"
                        Grid.Row="1"
                        Grid.Column="0"
                        Grid.ColumnSpan="3"
                        cal:Message.Attach="[Event LoadingRow] = [Action grdPrescription_LoadingRow($source, $eventArgs)];                         [Event Loaded] = [Action grdPrescription_Loaded($source, $eventArgs)];                         [Event Unloaded] = [Action grdPrescription_Unloaded($source, $eventArgs)];                         [Event CellEditEnding] = [Action grdPrescription_CellEditEnding($source, $eventArgs)]"
                        AutoGenerateColumns="False"
                        CanUserAddRows="False"
                        ColumnHeaderStyle="{StaticResource MainFrame.DataGridColumnHeaderStyle}"
                        HeadersVisibility="All"
                        HorizontalScrollBarVisibility="Auto"
                        ItemsSource="{Binding SelectedOutInvoice.OutwardDrugs, Mode=OneWay}"
                        SelectedItem="{Binding SelectedOutwardDrug, Mode=TwoWay}"
                        Style="{StaticResource MainFrame.DataGridStyle}"
                        VerticalScrollBarVisibility="Visible">
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Width="Auto">
                                <DataGridTemplateColumn.HeaderStyle>
                                    <Style BasedOn="{StaticResource MainFrame.DataGridColumnHeaderStyle}" TargetType="DataGridColumnHeader">
                                        <Setter Property="ContentTemplate">
                                            <Setter.Value>
                                                <DataTemplate>
                                                    <CheckBox
                                                        Margin="2,0,-13,0"
                                                        IsChecked="{Binding Path=DataContext.AllChecked, ElementName=LayoutRoot, Mode=TwoWay}"
                                                        IsThreeState="False"
                                                        ToolTipService.ToolTip="{Binding K2122_G1_ChonTatCa, Source={StaticResource eHCMSResources}}" />
                                                </DataTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </DataGridTemplateColumn.HeaderStyle>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <CheckBox
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            IsChecked="{Binding Checked, Mode=TwoWay}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn CellTemplate="{StaticResource ColDeleteTemplate}" />
                            <DataGridTextColumn
                                x:Name="colDrugID"
                                Binding="{Binding GetDrugForSellVisitor.DrugCode}"
                                ElementStyle="{StaticResource MainFrame.TextBlockCenterAlign}"
                                Header="{Binding T3649_G1_MaThuoc, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />

                            <DataGridTextColumn
                                x:Name="colDrugName"
                                Binding="{Binding GetDrugForSellVisitor.BrandName}"
                                ElementStyle="{StaticResource MainFrame.TextBlockLeftAlign}"
                                Header="{Binding T0904_G1_TenThuoc, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />

                            <DataGridTextColumn
                                x:Name="colContent"
                                Binding="{Binding GetDrugForSellVisitor.Content}"
                                ElementStyle="{StaticResource MainFrame.TextBlockCenterAlign}"
                                Header="{Binding T1316_G1_HLg, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />

                            <DataGridTextColumn
                                x:Name="colCityStateZipCode"
                                Binding="{Binding GetDrugForSellVisitor.UnitName}"
                                ElementStyle="{StaticResource MainFrame.TextBlockCenterAlign}"
                                Header="{Binding K3966_G1_Dvt, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />

                            <DataGridTemplateColumn
                                CellTemplate="{StaticResource ColChooseLoTemplate}"
                                Header="{Binding T2628_G1_LoSX, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />

                            <DataGridTextColumn
                                Binding="{Binding QtyOffer, Converter={StaticResource DecimalConverter}}"
                                ElementStyle="{StaticResource MainFrame.TextBlockRightAlign}"
                                Header="{Binding S0620_G1_SLgYC, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />

                            <DataGridTextColumn
                                Binding="{Binding OutQuantity, Mode=TwoWay, Converter={StaticResource DecimalConverter}, UpdateSourceTrigger=PropertyChanged}"
                                ElementStyle="{StaticResource MainFrame.TextBlockRightAlign}"
                                Header="{Binding G0771_G1_ThucXuat, Source={StaticResource eHCMSResources}}" />

                            <DataGridTextColumn
                                Binding="{Binding OutPrice, Converter={StaticResource DecimalConverter}}"
                                ElementStyle="{StaticResource MainFrame.TextBlockRightAlign}"
                                Header="{Binding K3591_G1_DGia, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />

                            <DataGridTextColumn
                                Binding="{Binding TotalPrice, Converter={StaticResource DecimalConverter}}"
                                ElementStyle="{StaticResource MainFrame.TextBlockRightAlign}"
                                Header="{Binding G0085_G1_TTien, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />

                            <DataGridTextColumn
                                x:Name="colTelephone"
                                Binding="{Binding InExpiryDate, Mode=OneWay, StringFormat='dd/MM/yyyy'}"
                                ElementStyle="{StaticResource MainFrame.TextBlockCenterAlign}"
                                Header="{Binding T1363_G1_HDung, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />

                            <DataGridTextColumn
                                x:Name="colLocation"
                                MinWidth="100"
                                Binding="{Binding SdlDescription, Mode=OneWay}"
                                ElementStyle="{StaticResource MainFrame.TextBlockLeftAlign}"
                                Header="{Binding G2209_G1_ViTri, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />

                            <DataGridTextColumn
                                Binding="{Binding VAT}"
                                ElementStyle="{StaticResource MainFrame.TextBlockCenterAlign}"
                                Header="{Binding G2156_G1_VAT, Source={StaticResource eHCMSResources}}"
                                IsReadOnly="True" />
                        </DataGrid.Columns>
                    </DataGrid>
                    <TextBlock
                        Grid.Row="2"
                        Grid.Column="0"
                        Width="70"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Text="{Binding G1691_G1_TThai, StringFormat='{}{0} :', Source={StaticResource eHCMSResources}}" />
                    <TextBlock
                        Grid.Row="2"
                        Grid.Column="0"
                        Margin="70,1,0,1"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Style="{StaticResource MainFrame.TextBlock.00}"
                        Text="{Binding SelectedOutInvoice.OutDrugInvStatus}" />
                    <TextBlock
                        Name="label3"
                        Grid.Row="2"
                        Grid.Column="1"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Foreground="Red"
                        Text="{Binding G1559_G1_TgTien, StringFormat='{}{0} :', Source={StaticResource eHCMSResources}}" />
                    <TextBlock
                        Grid.Row="2"
                        Grid.Column="2"
                        Margin="10,0,0,0"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        FontWeight="Bold"
                        Text="{Binding SumTotalPrice, Converter={StaticResource DecimalConverter}}"
                        TextAlignment="Right" />
                </Grid>
            </Border>
            <StackPanel
                Grid.Row="4"
                HorizontalAlignment="Right"
                Orientation="Horizontal">
                <Button
                    Name="btnDeleteHang"
                    Grid.Row="3"
                    Width="95"
                    Margin="2,1,30,1"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    Content="{Binding G2788_G1_XoaHg, Source={StaticResource eHCMSResources}}"
                    Style="{StaticResource MainFrame.Button}"
                    Visibility="{Binding bLuuTinhTien, Converter={StaticResource BooleanToVisibility}}" />
                <Button
                    Name="btnSave"
                    Grid.Row="3"
                    Width="95"
                    Margin="2,1"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    Content="{Binding T2937_G1_Luu, Source={StaticResource eHCMSResources}}"
                    IsEnabled="{Binding IsOther}"
                    Style="{StaticResource MainFrame.Button}"
                    Visibility="{Binding bLuuTinhTien, Converter={StaticResource BooleanToVisibility}}" />
                <Button
                    Name="btnCancel"
                    Grid.Row="3"
                    Width="75"
                    Margin="2,1"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    Content="{Binding K1305_G1_BoQua, Source={StaticResource eHCMSResources}}"
                    Style="{StaticResource MainFrame.Button}"
                    Visibility="{Binding bAdd, Converter={StaticResource BooleanToVisibility}}" />
            </StackPanel>
        </AxControls:AxGrid>
    </toolkit:BusyIndicator>
</UserControl>

<UserControl x:Class="aEMR.Pharmacy.Views.EstimationPharmacyView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    d:DesignHeight="550" d:DesignWidth="1100"
           xmlns:cal="http://www.caliburnproject.org"
           xmlns:AxControls="clr-namespace:aEMR.Controls;assembly=aEMR.Controls"
           xmlns:toolkit="http://schemas.xceed.com/wpf/xaml/toolkit"
             xmlns:Converters="clr-namespace:aEMR.Common.Converters;assembly=aEMR.Common"
    xmlns:Resources="clr-namespace:eHCMSLanguage;assembly=aEMRLanguage" >
    <UserControl.Resources>
	    <Resources:eHCMSResources x:Key="eHCMSResources"/>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibility"/>
        <Converters:DecimalConverter x:Key="DecimalConverter"/>
        <Converters:DecimalConverter2 x:Key="DecimalConverter2"/>
        <Converters:IsEnableFalseConverter x:Key="IsEnableFalseConverter"/>
        <DataTemplate x:Key="AutoCompleteTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock  Text="{Binding DrugCode}" Style="{StaticResource MainFrame.TextBlock.Auto}" Margin="0" Padding="0" />
                <TextBlock  Text=" - " Style="{StaticResource MainFrame.TextBlock.Auto}" Margin="0" Padding="0" />
            <TextBlock  Text="{Binding BrandName}" Style="{StaticResource MainFrame.TextBlock.Auto}" Margin="0" Padding="0" />
            </StackPanel>
            </DataTemplate>
        <DataTemplate x:Key="ColDeleteTemplate">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Button x:Name="lnkDelete"  cal:Message.Attach="[Event Click]=[Action lnkDelete_Click($source,$eventArgs)]" ToolTipService.ToolTip="{Binding G2617_G1_Xoa, Source={StaticResource eHCMSResources}}">
                        <Image Source="/aEMR.CommonViews;component/Assets/Images/Delete.png" Height="13" Width="13" Opacity="1" />
                </Button>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="NumberOfEstimatedMonthsCellTemplate">
            <Label Name="txtDrugName" Content="{Binding NumberOfEstimatedMonths_F,Converter={StaticResource DecimalConverter2}}" Margin="1,0,1,0" Padding="0" VerticalAlignment="Center" HorizontalAlignment="Right"/>
        </DataTemplate>
        <DataTemplate x:Key="NumberOfEstimatedMonthsCellEditTemplate">
            <AxControls:AxTextBox Name="txtDrugName" Text="{Binding NumberOfEstimatedMonths_F,Mode=TwoWay, UpdateSourceTrigger=Explicit,Converter={StaticResource DecimalConverter2}}"  Margin="0" Padding="0" VerticalAlignment="Center" TextAlignment="Right"
                                  cal:Message.Attach="[Event Loaded] = [Action txtNumberOfEstimatedMonths_Loaded($source, $eventArgs)]"/>
        </DataTemplate>
        <DataTemplate x:Key="PackageQtyCellTemplate">
            <StackPanel>
                <TextBlock Name="txtDrugName" Text="{Binding PackageQty,Converter={StaticResource DecimalConverter2}}" Style="{StaticResource MainFrame.TextBlock.CellRight}"/>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="PackageQtyCellEditTemplate">
            <StackPanel>
                <AxControls:AxTextBox Name="txtDrugName" Text="{Binding PackageQty,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,Converter={StaticResource DecimalConverter2}}"  Margin="0" Padding="0" VerticalAlignment="Center" TextAlignment="Right" />
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="AdjustedQtyCellTemplate">
            <StackPanel>
                <TextBlock Name="txtDrugName" Text="{Binding AdjustedQty,Converter={StaticResource DecimalConverter2}}" Style="{StaticResource MainFrame.TextBlock.CellRight}"/>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="AdjustedQtyCellEditTemplate">
            <StackPanel>
                <AxControls:AxTextBox Name="txtDrugName" Text="{Binding AdjustedQty,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,Converter={StaticResource DecimalConverter2}}"  Margin="0" Padding="0" VerticalAlignment="Center" TextAlignment="Right" />
            </StackPanel>
        </DataTemplate>
    </UserControl.Resources>
    <toolkit:BusyIndicator HorizontalAlignment="Stretch"
                                         VerticalAlignment="Stretch"
                                         IsBusy="{Binding IsLoading, Mode=OneWay}"                                         
                                         DisplayAfter="0:0:0.100"
                                         Margin="0,0,0,10">
        <Grid x:Name="LayoutRoot" >
            <Grid.RowDefinitions>
                <RowDefinition Height="30"/>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="10*"></ColumnDefinition>
                <ColumnDefinition Width="9*"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <TextBlock x:Name="TitleForm" Text="{Binding TitleForm}" Grid.ColumnSpan="2"
                               HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="#3595CB" 
                               FontSize="14" FontWeight="Bold" />
            <StackPanel Orientation="Horizontal" Margin="2" Grid.Row="1" 
                    Visibility="{Binding mDuTru_Tim,Converter={StaticResource BooleanToVisibility} }">
                <TextBlock HorizontalAlignment="Left" TextWrapping="Wrap" Text="{Binding T3463_G1_MaPhDuTru, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}" Margin="11,1,5,1" Style="{StaticResource MainFrame.TextBlock.02}"/>
                <TextBox  Margin="1,1,1,1" d:LayoutOverrides="Width" Style="{StaticResource MainFrame.TextBox}"  Text="{Binding SearchCriteria.Code,Mode=TwoWay}" Width="120" 
                      cal:Message.Attach="[Event KeyUp]=[Action Search_KeyUp($source,$eventArgs)]"></TextBox>
                <Button  Name="btnSearch" Content="{Binding G0981_G1_Tim, Source={StaticResource eHCMSResources}}" Margin="2,1,2,1" Style="{StaticResource MainFrame.Button}" Width="75" 
                     />
            </StackPanel>

            <Border Style="{StaticResource LightBlueBorderStyle}" Margin="2" Grid.Row="2">
                <Grid Visibility="{Binding mDuTru_ThongTin,Converter={StaticResource BooleanToVisibility} }">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="25"></RowDefinition>
                        <RowDefinition Height="25"></RowDefinition>
                        <RowDefinition Height="25"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                        <ColumnDefinition></ColumnDefinition>
                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                        <ColumnDefinition></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="{Binding G0651_G1_TTinPhDuTru, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" HorizontalAlignment="Left" VerticalAlignment="Center" Grid.ColumnSpan="4" Grid.Row="0" Grid.Column="0" Style="{StaticResource MainFrame.TextBlock.00}" />

                    <TextBlock Grid.Row="1" HorizontalAlignment="Right" TextWrapping="Wrap" Text="{Binding T3463_G1_MaPhDuTru, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}" Margin="5,1,5,1" Style="{StaticResource MainFrame.TextBlock.02}"/>
                    <TextBox Grid.Row="1" Grid.Column="1" Margin="1,1,1,0" d:LayoutOverrides="Width" Style="{StaticResource MainFrame.TextBox}"  Text="{Binding CurrentPharmacyEstimationForPO.EstimationCode,Mode=TwoWay}" IsReadOnly="True"/>
                    <TextBlock Grid.Row="2" HorizontalAlignment="Right" TextWrapping="Wrap" Margin="0,0,5,2" Text="{Binding N0061_G1_NgDuTru, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}"  Style="{StaticResource MainFrame.TextBlock.02}" />
                    <DatePicker Grid.Row="2"  Name="dpkEstimateDate" Grid.Column="1" Margin="1,1,1,0" d:LayoutOverrides="Width" Style="{StaticResource MainFrame.DatePicker}"   SelectedDate="{Binding CurrentPharmacyEstimationForPO.DateOfEstimation,Mode=TwoWay}" />

                    <Button Content="{Binding O0303_G1_OK, Source={StaticResource eHCMSResources}}" Grid.Row="2" Grid.Column="2" Width="25" HorizontalAlignment="Left" Name="btnOK" IsEnabled="{Binding CurrentPharmacyEstimationForPO.CanOK,Converter={StaticResource IsEnableFalseConverter}}" Style="{StaticResource MainFrame.Button}"/>
                    <TextBlock Grid.Row="1" Grid.Column="2" HorizontalAlignment="Right" TextWrapping="Wrap" Margin="0,0,5,2" Text="{Binding K2235_G1_ChuThich2, StringFormat='{}{0} ', Source={StaticResource eHCMSResources}}"  Style="{StaticResource MainFrame.TextBlock.02}" />
                    <TextBox Grid.Row="1" Grid.Column="3" Margin="1,1,1,0" d:LayoutOverrides="Width" Style="{StaticResource MainFrame.TextBox}" Grid.RowSpan="2" Text="{Binding CurrentPharmacyEstimationForPO.EstRemark,Mode=TwoWay}" AcceptsReturn="True" Width="150" HorizontalAlignment="Left"/>
                </Grid>
            </Border>
            <Border Style="{StaticResource LightBlueBorderStyle}" Margin="2" Grid.Row="2" Grid.Column="1">
                <Grid  Visibility="{Binding mDuTru_ThongTin,Converter={StaticResource BooleanToVisibility} }">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="25"></RowDefinition>
                        <RowDefinition Height="25"></RowDefinition>
                        <RowDefinition Height="25"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition></ColumnDefinition>
                        <ColumnDefinition></ColumnDefinition>
                        <ColumnDefinition></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="{Binding T2742_G1_LoaiDuTru, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" HorizontalAlignment="Left" VerticalAlignment="Center" Grid.ColumnSpan="4" Grid.Row="0" Grid.Column="0" Style="{StaticResource MainFrame.TextBlock.00}" />

                    <RadioButton GroupName="rdtEstimateType" Name="rdtFirstMonth" Content="{Binding K3130_G1_DauTh, Source={StaticResource eHCMSResources}}"  Grid.Row="1" Style="{StaticResource MainFrame.RadioButton}" IsChecked="{Binding IsFirstMonth,Mode=TwoWay}"  cal:Message.Attach="[Event Click]=[Action RadioButton_Click($source,$eventArgs)]" ></RadioButton>
                    <RadioButton GroupName="rdtEstimateType" Name="rdtAdditionFirstMonth" Content="{Binding K1357_G1_BoSungDauTh, Source={StaticResource eHCMSResources}}"  Grid.Row="1" Grid.Column="1" Style="{StaticResource MainFrame.RadioButton}" IsChecked="{Binding IsAdditionFirstMonth,Mode=TwoWay}"  cal:Message.Attach="[Event Click]=[Action RadioButton_Click($source,$eventArgs)]" ></RadioButton>
                    <RadioButton GroupName="rdtEstimateType" Name="rdtModifyMonth" Content="{Binding K1361_G1_BoSungTrongTh, Source={StaticResource eHCMSResources}}" Grid.Row="1" Grid.Column="2" Style="{StaticResource MainFrame.RadioButton}" IsChecked="{Binding IsModifyMonth,Mode=TwoWay}" cal:Message.Attach="[Event Click]=[Action RadioButton_Click($source,$eventArgs)]"></RadioButton>
                    <RadioButton GroupName="rdtEstimateType" Name="rdtFirstYear" Content="{Binding K3127_G1_DauNam, Source={StaticResource eHCMSResources}}" Grid.Column="0" Grid.Row="2" Style="{StaticResource MainFrame.RadioButton}" IsChecked="{Binding IsFirstYear,Mode=TwoWay}" cal:Message.Attach="[Event Click]=[Action RadioButton_Click($source,$eventArgs)]" ></RadioButton>
                    <RadioButton GroupName="rdtEstimateType" Name="rdtModifyYear" Content="{Binding K1359_G1_BoSungTrongNam, Source={StaticResource eHCMSResources}}" Grid.Row="2" Grid.Column="1" Style="{StaticResource MainFrame.RadioButton}" IsChecked="{Binding IsModifyYear,Mode=TwoWay}" cal:Message.Attach="[Event Click]=[Action RadioButton_Click($source,$eventArgs)]" ></RadioButton>
                </Grid>
            </Border>

            <Border Style="{StaticResource LightBlueBorderStyle}" Grid.Row="3" Margin="2" Grid.ColumnSpan="2">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"></RowDefinition>
                        <RowDefinition Height="Auto"></RowDefinition>
                        <RowDefinition Height="Auto"></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition Height="Auto"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Expander Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" VerticalAlignment="Stretch" Foreground="#CC0033" FontWeight="Bold"
                                ExpandDirection="Down" IsExpanded="False" 
                              Header="{Binding G0266_G1_ThemHg, StringFormat='{}{0} :', Source={StaticResource eHCMSResources}}" 
                              Background="#FFDBE5F1"
                                RenderTransformOrigin="0,0" Height="Auto"
                                HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch">
                        <!--<TextBlock Text="{Binding K1852_G1_CTietPhDuTru2, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" HorizontalAlignment="Left" VerticalAlignment="Center" Grid.ColumnSpan="4" Grid.Row="0" Grid.Column="0" Style="{StaticResource MainFrame.TextBlock.00}" />-->
                    <Border Margin="2" Style="{StaticResource LightBlueBorderStyle}" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" Visibility="{Binding VisibilityAdd}">
                        <AxControls:AxGrid Name="grid1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                <ColumnDefinition Width="85*" MaxWidth="85" MinWidth="55"></ColumnDefinition>
                                <ColumnDefinition Width="300*"></ColumnDefinition>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                <ColumnDefinition Width="60*" MaxWidth="60" ></ColumnDefinition>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                <ColumnDefinition Width="70*" MaxWidth="80"></ColumnDefinition>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                <ColumnDefinition Width="60*" MaxWidth="80"></ColumnDefinition>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                <ColumnDefinition Width="50*" MaxWidth="80"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition></RowDefinition>
                                <RowDefinition></RowDefinition>
                            </Grid.RowDefinitions>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Margin="2,1" Text="{Binding K2170_G1_ChonThuoc, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.02}"></TextBlock>
                                <RadioButton Content="{Binding K2569_G1_Code, Source={StaticResource eHCMSResources}}" Margin="2,1" GroupName="ChooseDrug"  cal:Message.Attach="[Event Checked]=[Action Code_Checked($source,$eventArgs)]"></RadioButton>
                                <RadioButton Content="{Binding T0829_G1_Ten, Source={StaticResource eHCMSResources}}" Margin="2,1" GroupName="ChooseDrug" IsChecked="True"  cal:Message.Attach="[Event Checked]=[Action Name_Checked($source,$eventArgs)]"></RadioButton>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Grid.Row="1" VerticalAlignment="Center">
                                <TextBlock Margin="2,1" Text="{Binding S0605_G1_SLgQuyCach, StringFormat='{}{0}:', Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.02}"></TextBlock>
                                <TextBlock Margin="2,1" Text="{Binding CurrentPharmacyEstimationForPoDetail.RefGenMedProductDetails.UnitPackaging,Mode=OneWay}" Style="{StaticResource MainFrame.TextBlock.02}"></TextBlock>
                                <TextBlock Margin="2,1" Text="{Binding Z0028_G1_DauNgoacTrai, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.02}"></TextBlock>
                                <TextBlock Margin="2,1" Text="{Binding CurrentPharmacyEstimationForPoDetail.RefGenMedProductDetails.Packaging}" Style="{StaticResource MainFrame.TextBlock.02}"></TextBlock>
                                <TextBlock Margin="2,1" Text="{Binding Z0027_G1_DauNgoacPhai, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.02}"></TextBlock>
                            </StackPanel>

                            <AxControls:AxTextBox Grid.Column="1" Margin="2,1" Style="{StaticResource MainFrame.TextBox}" Text="{Binding CurrentPharmacyEstimationForPoDetail.RefGenMedProductDetails.DrugCode,Mode=TwoWay}" cal:Message.Attach="[Event LostFocus] = [Action AxTextBox_LostFocus($source, $eventArgs)];[Event Loaded] = [Action AxTextBox_Loaded($source, $eventArgs)]" TabIndex="0"
                                                   IsEnabled="{Binding VisibilityCode,Mode=OneWay}" />
                            <AxControls:AxAutoComplete Text="{Binding CurrentPharmacyEstimationForPoDetail.RefGenMedProductDetails.BrandName}" Name="AutoDrug_Text" Grid.Column="2" Margin="2,1" IsTabStop="False" ValueMemberBinding="{Binding BrandName, Mode=TwoWay}"   
                                              cal:Message.Attach="[Event Populating] = [Action AutoCompleteBox_Populating($source, $eventArgs)]
                                                       ;[Event DropDownClosed] = [Action AutoDrug_Text_DropDownClosed($source, $eventArgs)]
                                                       ;[Event Loaded] = [Action AutoDrug_Text_Loaded($source, $eventArgs)]"
                                                  TextBoxStyle="{StaticResource MainFrame.TextBox}" FontWeight="Bold"
                                                  IsEnabled="{Binding VisibilityName,Mode=OneWay}" TabIndex="1" SelectedItem="{Binding CurrentRefGenericDrugDetail,Mode=TwoWay}"
                                                   Style="{StaticResource AxAutoCompleteMyStyle}"    ItemTemplate="{StaticResource AutoCompleteTemplate}"  ItemsSource="{Binding RefGenericDrugDetail,Mode=OneWay}">

                            </AxControls:AxAutoComplete>

                            <TextBlock Margin="2,1" Grid.Row="1" Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Center" Text="{Binding N0175_G1_NhaCC, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.01}"/>
                            <TextBox Grid.Column="2" Grid.Row="1" Margin="2,1" Style="{StaticResource MainFrame.TextBox}" Text="{Binding CurrentPharmacyEstimationForPoDetail.RefGenMedProductDetails.SupplierMain.SupplierName,Mode=OneWay}" IsEnabled="False"></TextBox>

                            <TextBlock Margin="2,1" Grid.Column="3" HorizontalAlignment="Right" VerticalAlignment="Center" Text="{Binding K3966_G1_Dvt, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.01}"/>
                            <TextBox Grid.Column="4" Margin="2,1" Style="{StaticResource MainFrame.TextBox}" Text="{Binding CurrentPharmacyEstimationForPoDetail.RefGenMedProductDetails.SeletedUnit.UnitName,Mode=OneWay}" IsEnabled="False"></TextBox>

                            <TextBlock Margin="2,1" Grid.Column="5" HorizontalAlignment="Right" VerticalAlignment="Center" Text="{Binding S0610_G1_SLgTon, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.01}"/>
                            <AxControls:AxTextBox Grid.Column="6" Margin="2,1" Style="{StaticResource MainFrame.TextBox}" TextAlignment="Right" Text="{Binding CurrentPharmacyEstimationForPoDetail.RemainQty,Converter={StaticResource DecimalConverter}}" IsEnabled="False"></AxControls:AxTextBox>

                            <TextBlock Margin="2,1" Grid.Row="0" Grid.Column="9" HorizontalAlignment="Right" VerticalAlignment="Center" Text="{Binding G2131_G1_UuTien, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.01}"/>
                            <AxControls:AxTextBox Grid.Row="0" Grid.Column="10" Margin="2,1" Style="{StaticResource MainFrame.TextBox}" TextAlignment="Right" Text="{Binding CurrentPharmacyEstimationForPoDetail.Priority,Converter={StaticResource DecimalConverter}}" IsEnabled="False"></AxControls:AxTextBox>

                            <TextBlock Margin="2,1" Grid.Row="1" Grid.Column="3" HorizontalAlignment="Right" VerticalAlignment="Center" Text="{Binding T1435_G1_HeSN, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.01}"/>
                                <AxControls:AxTextBox Grid.Row="1" Grid.Column="4" Margin="2,1" Style="{StaticResource MainFrame.TextBox}" TextAlignment="Right" Text="{Binding CurrentPharmacyEstimationForPoDetail.NumberOfEstimatedMonths_F,Converter={StaticResource DecimalConverter2}}" TabIndex="2" cal:Message.Attach="[Event Loaded] = [Action HeSoNhan_Loaded($source, $eventArgs)];[Event LostFocus] = [Action AxHSN_LostFocus($source, $eventArgs)]"></AxControls:AxTextBox>

                            <TextBlock Margin="2,1" Grid.Row="1" Grid.Column="5" HorizontalAlignment="Right" VerticalAlignment="Center" Text="{Binding S0615_G1_SLgDG, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.01}"/>
                            <AxControls:AxTextBox Grid.Row="1" Grid.Column="6" Margin="2,1" Style="{StaticResource MainFrame.TextBox}" TextAlignment="Right" Text="{Binding CurrentPharmacyEstimationForPoDetail.PackageQty,Mode=TwoWay,Converter={StaticResource DecimalConverter}}" TabIndex="3"
                                                  cal:Message.Attach="[Event LostFocus] = [Action txtQtyPackaging_LostFocus($source, $eventArgs)]"></AxControls:AxTextBox>

                            <TextBlock Margin="2,1" Grid.Column="7"   HorizontalAlignment="Right" VerticalAlignment="Center" Text="{Binding T0823_G1_TBXuat, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.01}"/>
                            <AxControls:AxTextBox Grid.Column="8" Margin="2,1" Style="{StaticResource MainFrame.TextBox}" TextAlignment="Right" Text="{Binding CurrentPharmacyEstimationForPoDetail.OutAverageQty,Mode=OneWay,Converter={StaticResource DecimalConverter}}" IsEnabled="False" ></AxControls:AxTextBox>

                            <TextBlock Margin="2,1" Grid.Row="1" Grid.Column="7"   HorizontalAlignment="Right" VerticalAlignment="Center" Text="{Binding S0596_G1_SLgDuTru, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.01}"/>
                            <AxControls:AxTextBox Grid.Row="1" Grid.Column="8" Margin="2,1" Style="{StaticResource MainFrame.TextBox}" TextAlignment="Right" Text="{Binding CurrentPharmacyEstimationForPoDetail.AdjustedQty,Mode=TwoWay,Converter={StaticResource DecimalConverter}}"  TabIndex="4"
                                                  cal:Message.Attach="[Event LostFocus] = [Action txtAdjustedQty_LostFocus($source, $eventArgs)]"></AxControls:AxTextBox>

                            <Button Content="{Binding G0156_G1_Them, Source={StaticResource eHCMSResources}}" Grid.ColumnSpan="2" Grid.Column="9" Grid.Row="1"  Margin="2,1"  Name="AddItem" VerticalAlignment="Center"  Style="{StaticResource MainFrame.Button}" IsEnabled="{Binding SelectedOutwardInfo.CanSaveAndPaid,Mode=OneWay}" TabIndex="5"/>
                        </AxControls:AxGrid>
                    </Border>
                    </Expander>
                    <Border  Margin="2" Grid.Row="2" Style="{StaticResource LightBlueBorderStyle}" >
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <CheckBox Content="{Binding P0353_G1_PhanTrang, Source={StaticResource eHCMSResources}}" VerticalAlignment="Center" Margin="2,1" Style="{StaticResource MainFrame.Checkbox}" cal:Message.Attach="[Event Checked] = [Action Paging_Checked($source, $eventArgs)];[Event Unchecked] = [Action Paging_Unchecked($source, $eventArgs)]"></CheckBox>
                            <TextBlock Text="{Binding S0637_G1_SoDong_Trang, Source={StaticResource eHCMSResources}}" VerticalAlignment="Center" Margin="5,1,2,1" Style="{StaticResource MainFrame.TextBlock.01}" Visibility="{Binding VisibilityPaging}"></TextBlock>
                            <ComboBox Margin="2,1" Name="cbxPageSize" Style="{StaticResource MainFrame.ComboBox}" MinWidth="50" cal:Message.Attach="[Event SelectionChanged] = [Action cbxPageSize_SelectionChanged($source, $eventArgs)]"
                          Visibility="{Binding VisibilityPaging}">
                                <ComboBoxItem Content="5"></ComboBoxItem>
                                <ComboBoxItem Content="10"></ComboBoxItem>
                                <ComboBoxItem IsSelected="True" Content="15"></ComboBoxItem>
                                <ComboBoxItem Content="20"></ComboBoxItem>
                                <ComboBoxItem Content="25"></ComboBoxItem>
                            </ComboBox>
                            <TextBlock Text="{Binding T2900_G1_LocTheoTenThuoc, Source={StaticResource eHCMSResources}}" VerticalAlignment="Center" Margin="5,1,2,1" Style="{StaticResource MainFrame.TextBlock.00}"></TextBlock>
                            <TextBox Name="SearchKey" Style="{StaticResource MainFrame.TextBox}" MinWidth="120" Margin="2,1" cal:Message.Attach="[Event KeyUp] = [Action SearchKey_KeyUp($source, $eventArgs)]"></TextBox>
                            <Button Name="btnFilter" Content="{Binding G0739_G1_THien, Source={StaticResource eHCMSResources}}" Width="75" Margin="2,1" Style="{StaticResource MainFrame.Button}"></Button>
                        </StackPanel>
                    </Border>
                    <AxControls:AxDataGridNy x:Name="grdEstimateDetails" Grid.Row="3" HeadersVisibility="All" AutoGenerateColumns="False" ColumnHeaderStyle="{StaticResource MainFrame.DataGridColumnHeaderStyle.01}" 
                      Height="Auto" Width="Auto"
                                             Style="{StaticResource MainFrame.DataGridStyle.OneColor}" ItemsSource="{Binding CV_PCVEstimationDetails}"  
                                         cal:Message.Attach="[Event LoadingRow]=[Action grdRequestDetails_LoadingRow($source,$eventArgs)]
                                                            ;[Event Loaded]=[Action grdEstimateDetails_Loaded($source,$eventArgs)]
                                                            ;[Event CellEditEnding]=[Action grdEstimateDetails_CellEditEnding($source,$eventArgs)]
                                             ;[Event PreparingCellForEdit]=[Action grdEstimateDetails_PreparingCellForEdit($source,$eventArgs)]"
                                         FrozenColumnCount="{Binding CDC,Mode=OneWay}" CanUserSortColumns="False" 
                        IsReadOnly="{Binding IsOrder,TargetNullValue=false}" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Width="Auto" >
                                <DataGridTemplateColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <CheckBox IsThreeState="False" IsChecked="{Binding Path=DataContext.AllChecked, ElementName=LayoutRoot, Mode=TwoWay}" ToolTipService.ToolTip="{Binding K2122_G1_ChonTatCa, Source={StaticResource eHCMSResources}}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.HeaderTemplate>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding Checked, Mode=TwoWay, UpdateSourceTrigger = PropertyChanged}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn CanUserSort="False" CellTemplate="{StaticResource ColDeleteTemplate}" MinWidth="25" MaxWidth="30" IsReadOnly="True" />

                            <DataGridTextColumn Header="{Binding K2569_G1_Code,Source={StaticResource eHCMSResources}}" CanUserSort="False" Width="70" Binding="{Binding RefGenMedProductDetails.DrugCode,Mode=OneWay}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnly}"/>

                            <DataGridTextColumn Header="{Binding T0904_G1_TenThuoc, Source={StaticResource eHCMSResources}}" CanUserSort="False" CanUserResize="True"  Binding="{Binding RefGenMedProductDetails.BrandName,Mode=OneWay}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnlyLeft}"/>

                            <DataGridTextColumn Header="{Binding T1681_G1_HoatChat, Source={StaticResource eHCMSResources}}" CanUserSort="False" CanUserResize="True"  Binding="{Binding RefGenMedProductDetails.GenericName,Mode=OneWay}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnlyLeft}"/>

                            <DataGridTextColumn Header="{Binding T1410_G1_HgSX2, Source={StaticResource eHCMSResources}}" CanUserSort="False" MinWidth="60" Binding="{Binding RefGenMedProductDetails.PharmaceuticalCompany.PCOName}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnly}"/>

                            <DataGridTextColumn Header="{Binding Q0420_G1_QCDongGoi, Source={StaticResource eHCMSResources}}" CanUserSort="False" MinWidth="60" Binding="{Binding RefGenMedProductDetails.Packaging}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnly}"/>

                            <DataGridTextColumn Header="{Binding S0605_G1_SLgQuyCach, Source={StaticResource eHCMSResources}}" CanUserSort="False" MaxWidth="80" Binding="{Binding RefGenMedProductDetails.UnitPackaging,Converter={StaticResource DecimalConverter2}}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnly}"/>

                            <DataGridTextColumn Header="{Binding S0610_G1_SLgTon, Source={StaticResource eHCMSResources}}" CanUserSort="False" Width="60" Binding="{Binding RemainQty,Converter={StaticResource DecimalConverter2}}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnly}"/>

                            <DataGridTextColumn CanUserSort="False" Width="60" Binding="{Binding OutQtyPrevFourthMonth,Converter={StaticResource DecimalConverter2}}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnlyFlight}"/>
                            <DataGridTextColumn CanUserSort="False" Width="60" Binding="{Binding OutQtyPrevThirdMonth,Converter={StaticResource DecimalConverter2}}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnlyFlight}"/>
                            <DataGridTextColumn CanUserSort="False" Width="60" Binding="{Binding OutQtyPrevSecondMonth,Converter={StaticResource DecimalConverter2}}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnlyFlight}"/>
                            <DataGridTextColumn CanUserSort="False" Width="60" Binding="{Binding OutQtyPrevFirstMonth,Converter={StaticResource DecimalConverter2}}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnlyFlight}"/>
                            <DataGridTextColumn Header="{Binding T0823_G1_TBXuat, Source={StaticResource eHCMSResources}}" CanUserSort="False" Width="60" Binding="{Binding OutAverageQty,Converter={StaticResource DecimalConverter2}}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnly}"/>

                            <DataGridTextColumn Header="{Binding K3563_G1_DoUuTien, Source={StaticResource eHCMSResources}}" CanUserSort="False" Width="60" Binding="{Binding Priority,Converter={StaticResource DecimalConverter2}}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnly}"/>

                            <DataGridTemplateColumn Header="{Binding T1437_G1_HeSoNhan, Source={StaticResource eHCMSResources}}" CanUserSort="False" AxControls:DataGridColNamingUtil.ColName="colNumOfEstimatedMonth"  Width="60" CellTemplate="{StaticResource NumberOfEstimatedMonthsCellTemplate}" CellEditingTemplate="{StaticResource NumberOfEstimatedMonthsCellEditTemplate}" CellStyle="{StaticResource CellStyleVerticalAlignCenter}"/>

                            <DataGridTextColumn Header="{Binding S0602_G1_SLgLyThuyet, Source={StaticResource eHCMSResources}}" CanUserSort="False" Width="60" Binding="{Binding EstimatedQty_F,Converter={StaticResource DecimalConverter2}}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnlyFlight}"/>

                            <DataGridTemplateColumn CanUserSort="False" AxControls:DataGridColNamingUtil.ColName="colQtyPackaging"  Header="SL Đóng gói"  Width="60" CellTemplate="{StaticResource PackageQtyCellTemplate}" CellEditingTemplate="{StaticResource PackageQtyCellEditTemplate}" CellStyle="{StaticResource CellStyleVerticalAlignCenter}"/>
                            <DataGridTemplateColumn Header="{Binding S0596_G1_SLgDuTru, Source={StaticResource eHCMSResources}}" CanUserSort="False" AxControls:DataGridColNamingUtil.ColName="colAdjustedQty"  Width="70" CellTemplate="{StaticResource AdjustedQtyCellTemplate}" CellEditingTemplate="{StaticResource AdjustedQtyCellEditTemplate}" CellStyle="{StaticResource CellStyleVerticalAlignCenter}"/>

                            <DataGridTextColumn Header="{Binding K3709_G1_DViTinh, Source={StaticResource eHCMSResources}}" CanUserSort="False" Width="65" Binding="{Binding RefGenMedProductDetails.SeletedUnit.UnitName}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnly}"/>

                            <!--<DataGridTextColumn Header="{Binding K3591_G1_DGia, Source={StaticResource eHCMSResources}}" CanUserResize="True" CanUserReorder="True" CanUserSort="True" Width="80" IsReadOnly="True"/>-->
                            <DataGridTextColumn Header="{Binding S0613_G1_SLgXuat12Thang, Source={StaticResource eHCMSResources}}" CanUserSort="False" Width="85" Binding="{Binding OutQtyLastTwelveMonths,Converter={StaticResource DecimalConverter2}}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnly}"/>

                            <DataGridTextColumn CanUserSort="False" Width="60" Binding="{Binding ToDateOutQty,Converter={StaticResource DecimalConverter2}}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnly}"/>
                            <DataGridTextColumn Header="{Binding K3591_G1_DGia, Source={StaticResource eHCMSResources}}" CanUserSort="False" Width="80" Binding="{Binding UnitPrice,Converter={StaticResource DecimalConverter}}" CellStyle="{StaticResource CellStyleReadOnlyRight}" IsReadOnly="True"/>

                            <DataGridTextColumn Header="{Binding G0085_G1_TTien, Source={StaticResource eHCMSResources}}" CanUserSort="False" Width="80" Binding="{Binding TotalPrice,Converter={StaticResource DecimalConverter}}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnlyRight}"/>

                            <DataGridTextColumn Header="{Binding N0179_G1_NCCChinh, Source={StaticResource eHCMSResources}}" CanUserSort="False" MinWidth="90" Binding="{Binding RefGenMedProductDetails.SupplierMain.SupplierName}" IsReadOnly="True" CellStyle="{StaticResource CellStyleReadOnlyLeft}"/>

                        </DataGrid.Columns>
                    </AxControls:AxDataGridNy>
                    <AxControls:DataPager x:Name="pagerStockTakes" PageSize="{Binding PCVPageSize,Mode=TwoWay}" Margin="2,1"
                                          Grid.Row="5" Visibility="{Binding VisibilityPaging}"
                       Height="24"  VerticalAlignment="Center" 
                       cal:Message.Attach="[Event Loaded] = [Action pagerStockTakes_Loaded($source, $eventArgs)]"></AxControls:DataPager>
                </Grid>
            </Border>
            <Grid Grid.Row="4" Grid.ColumnSpan="2">
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                    <ColumnDefinition></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <StackPanel  Orientation="Horizontal" HorizontalAlignment="Left" Grid.Column="0" VerticalAlignment="Center">
                    <TextBlock Text="{Binding T1437_G1_HeSoNhan, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.00}" Margin="2"></TextBlock>
                    <TextBox Text="{Binding HeSoNhan,Mode=TwoWay,ValidatesOnExceptions=True}" Style="{StaticResource MainFrame.TextBox}" Margin="2" Width="50" TextAlignment="Right" IsReadOnly="{Binding IsOrder}"></TextBox>

                    <TextBlock Text="{Binding S0628_G1_SoCotCoDinh, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.00}" Margin="2"></TextBlock>
                    <TextBox Text="{Binding CDC,Mode=TwoWay,ValidatesOnExceptions=True}" Style="{StaticResource MainFrame.TextBox}" Margin="2" Width="50" TextAlignment="Right"></TextBox>
                </StackPanel>
                <StackPanel  Orientation="Horizontal" HorizontalAlignment="Right" Grid.Column="1">
                    <Button Name="btnDeleteHang" Content="{Binding G2788_G1_XoaHg, Source={StaticResource eHCMSResources}}" Margin="2,1,30,1" Style="{StaticResource MainFrame.Button}" Width="75"  IsEnabled="{Binding IsOrder,Converter={StaticResource IsEnableFalseConverter}}" 
                        Visibility="{Binding mDuTru_Xoa,Converter={StaticResource BooleanToVisibility} }"/>
                    <Button Name="btnNew" Content="{Binding P0373_G1_PhMoi, Source={StaticResource eHCMSResources}}" Margin="2,1,2,1" Style="{StaticResource MainFrame.Button}" Width="75" IsEnabled="{Binding CurrentPharmacyEstimationForPO.CanNew,TargetNullValue='False'}"
                        Visibility="{Binding mDuTru_PhieuMoi,Converter={StaticResource BooleanToVisibility} }"/>
                    <Button Name="btnSave" Content="{Binding T2937_G1_Luu, Source={StaticResource eHCMSResources}}" Margin="2,1,2,1" Style="{StaticResource MainFrame.Button}" Width="75" IsEnabled="{Binding CurrentPharmacyEstimationForPO.CanSave,TargetNullValue='False'}"
                        Visibility="{Binding mDuTru_PhieuMoi,Converter={StaticResource BooleanToVisibility} }"/>
                    <Button Name="btnExportExcel" Content="{Binding G2849_G1_XuatExcel, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.Button}" Width="75" Margin="2,1" IsEnabled="{Binding CurrentPharmacyEstimationForPO.CanPrint,TargetNullValue='False'}"/>
                    <Button Name="btnDeletePhieu" Content="{Binding G2812_G1_XoaPh, Source={StaticResource eHCMSResources}}" Margin="2,1,2,1" Style="{StaticResource MainFrame.Button}" Width="75"  IsEnabled="{Binding CurrentPharmacyEstimationForPO.CanDelete,TargetNullValue='False'}" 
                        Visibility="{Binding mDuTru_Xoa,Converter={StaticResource BooleanToVisibility} }"/>

                    <!--<Button Name="btnPrint" Content="{Binding T1820_G1_In, Source={StaticResource eHCMSResources}}" Margin="2,1,2,1" Style="{StaticResource MainFrame.Button}" Width="75" IsEnabled="{Binding CurrentPharmacyEstimationForPO.CanPrint,TargetNullValue='False'}"
                        Visibility="{Binding mDuTru_ReportIn,Converter={StaticResource BooleanToVisibility} }"/>-->
                </StackPanel>
                <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Right" >
                    <TextBlock Text="{Binding N0177_G1_NCC, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.00}" Margin="2"></TextBlock>
                    <AxControls:AxAutoComplete Width="200" IsTabStop="False" 
                                                ValueMemberBinding="{Binding SupplierName, Mode=TwoWay}"   
                                                cal:Message.Attach="[Event Populating] = [Action Supplier_Populating($source, $eventArgs)]"     
                                                FontWeight="Bold" IsDropDownOpen="True" Style="{StaticResource MainFrame.AutoCompleteBox}"
                                                TextBoxStyle="{StaticResource MainFrame.TextBox}" MinimumPrefixLength="0" MinimumPopulateDelay="300"
                                                Grid.Row="2" Grid.Column="8"  Margin="2,1" SelectedItem="{Binding SelectedSupplier,Mode=TwoWay}"
                                                
                                             FilterMode="None"
                                                Visibility="{Binding ElementName=LayoutRoot,Path=DataContext.Visibility}"
                                         IsEnabled="{Binding CurrentPharmacyEstimationForPO.CanPrint,TargetNullValue='False'}"
                                               ItemContainerStyle="{StaticResource AxAutoCompleteBoxBkg}">
                        <AxControls:AxAutoComplete.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding SupplierCode}" Style="{StaticResource MainFrame.TextBlock.Auto}" Margin="0,0,10,0" Width="160" HorizontalAlignment="Left" />
                                    <TextBlock Text="{Binding SupplierName}" Style="{StaticResource MainFrame.TextBlock.Auto}" Margin="0" Padding="0" HorizontalAlignment="Left"/>
                                </StackPanel>
                            </DataTemplate>
                        </AxControls:AxAutoComplete.ItemTemplate>
                    </AxControls:AxAutoComplete>

                    <Button Width="20" Name="btnSupplier" Content="..." Grid.Row="2" Grid.Column="9" Margin="2,1,15, 0" Style="{StaticResource MainFrame.Button}" IsEnabled="{Binding CurrentPharmacyEstimationForPO.CanPrint,TargetNullValue='False'}"/>

                    <TextBlock Text="{Binding N0180_G1_NhaSX, Source={StaticResource eHCMSResources}}" Style="{StaticResource MainFrame.TextBlock.00}" Margin="2"></TextBlock>
                    <AxControls:AxAutoComplete Width="150" Margin="4,2,5,2" IsTabStop="False" 
                                                  ValueMemberBinding="{Binding PCOName, Mode=TwoWay}"   
                                                  FontWeight="Bold" IsDropDownOpen="True" Style="{StaticResource MainFrame.AutoCompleteBox}"
                                                  TextBoxStyle="{StaticResource MainFrame.TextBox}" MinimumPrefixLength="0"
                                                  SelectedItem="{Binding SelectedPharmaceuticalCompany,NotifyOnValidationError=True,Mode=TwoWay}"
                                                  ItemsSource="{Binding PharmaceuticalCompanies}"
                                         IsEnabled="{Binding CurrentPharmacyEstimationForPO.CanPrint,TargetNullValue='False'}"
                                               ItemContainerStyle="{StaticResource AxAutoCompleteBoxBkg}">
                        <AxControls:AxAutoComplete.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding PCOName}"></TextBlock>
                            </DataTemplate>
                        </AxControls:AxAutoComplete.ItemTemplate>
                    </AxControls:AxAutoComplete>

                    <Button Width="20" Name="btnSearchNSX" Margin="2,1" Content="..." Grid.Row="1" Grid.Column="9" Style="{StaticResource MainFrame.Button}" IsEnabled="{Binding CurrentPharmacyEstimationForPO.CanPrint,TargetNullValue='False'}"
                             ToolTipService.ToolTip="QLDM NSX"/>

                    <Button Name="btnPreview" Content="{Binding G2521_G1_XemIn, Source={StaticResource eHCMSResources}}" Margin="2,1,2,1" Style="{StaticResource MainFrame.Button}" Width="75" IsEnabled="{Binding CurrentPharmacyEstimationForPO.CanPrint,TargetNullValue='False'}"
                        Visibility="{Binding mDuTru_ReportIn,Converter={StaticResource BooleanToVisibility} }"/>

                </StackPanel>
            </Grid>

        </Grid>
    </toolkit:BusyIndicator>
</UserControl>
